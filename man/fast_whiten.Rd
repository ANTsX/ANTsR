% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{fast_whiten}
\alias{fast_whiten}
\title{Fast Matrix Whitening}
\usage{
fast_whiten(X, epsilon = 1e-08)
}
\arguments{
\item{X}{A numeric matrix of size \eqn{n \times p}, where \eqn{n} is the
number of samples (rows) and \eqn{p} is the number of features (columns).}

\item{epsilon}{A small non-negative numeric value used to stabilize the
inversion of singular values (default = 1e-8).}
}
\value{
A numeric matrix of the same dimensions as \code{X}, with whitened
  columns. The covariance of the whitened data is approximately the identity
  in the relevant space.
}
\description{
Perform whitening (sphering) of a data matrix \eqn{X} such that the
covariance matrix of the output is approximately the identity.  
The implementation automatically chooses the most efficient algorithm
depending on whether the number of features \eqn{p} is much larger than
the number of samples \eqn{n} (\eqn{p >> n}) or vice versa (\eqn{n >> p}).
}
\details{
Whitening is performed via an SVD-based approach with Tikhonov-style
regularization to handle small singular values.


- If \eqn{p > n}, whitening is computed in the sample space
  (avoids forming a \eqn{p \times p} covariance).
- If \eqn{n >= p}, whitening is computed in the feature space
  (avoids forming an \eqn{n \times n} covariance).

Computational complexity:
\itemize{
  \item \eqn{O(n^2 p)} when \eqn{p >> n}
  \item \eqn{O(n p^2)} when \eqn{n >> p}
}
}
\examples{
set.seed(42)

# Case 1: p >> n
X1 <- matrix(rnorm(50 * 2000), 50, 2000)
Xw1 <- fast_whiten(X1)
round(cov(t(Xw1))[1:5, 1:5], 3)

# Case 2: n >> p
X2 <- matrix(rnorm(2000 * 50), 2000, 50)
Xw2 <- fast_whiten(X2)
round(cov(Xw2)[1:5, 1:5], 3)

}
