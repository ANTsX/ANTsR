% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{estimate_learning_rate_nsa}
\alias{estimate_learning_rate_nsa}
\title{Estimate Robust Learning Rate for NSA-Flow}
\usage{
estimate_learning_rate_nsa(
  Y0,
  X0,
  w = 0.5,
  retraction = "soft_polar",
  nsa_energy = NULL,
  apply_nonneg = TRUE,
  method = c("brent", "grid", "armijo", "golden", "adaptive", "default"),
  search_range = c(-8, 2),
  verbose = TRUE,
  plot = TRUE
)
}
\arguments{
\item{Y0}{Numeric matrix, initial point.}

\item{X0}{Numeric matrix, target matrix.}

\item{w}{Weighting parameter between fidelity and orthogonality.}

\item{retraction}{Retraction method used by nsa_flow.}

\item{nsa_energy}{Optional function(Y) to compute NSA energy; if NULL, uses default.}

\item{apply_nonneg}{Logical; if TRUE, applies nonnegativity.}

\item{method}{Character; learning rate estimation method:
one of c("brent", "grid", "armijo", "golden", "adaptive").
"default" returns fixed values (0.001 if nonneg, else 1.0).}

\item{search_range}{Numeric vector of length 2; log10(alpha) search range}

\item{verbose}{Logical; if TRUE, prints diagnostics.}

\item{plot}{Logical; if TRUE, plots energy vs learning rate (if applicable).}
}
\value{
A list with:
  \itemize{
    \item \code{estimated_learning_rate}: numeric, chosen value.
    \item \code{search_df}: data frame with log10(alpha), alpha, and energy (if available).
    \item \code{plot}: ggplot object (if \code{plot=TRUE}), otherwise NULL.
  }
}
\description{
General-purpose estimator for an initial learning rate in \code{nsa_flow()},
supporting multiple automatic strategies including the original Brent line search.
}
