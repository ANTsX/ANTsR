% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{nsa_flow_fa}
\alias{nsa_flow_fa}
\title{NSA-Flow Regularized Factor Analysis}
\usage{
nsa_flow_fa(
  data = NULL,
  R = NULL,
  nfactors,
  rotate = c("varimax", "none", "promax", "oblimin"),
  nsa_w = 0.5,
  anneal_w = FALSE,
  nsa_max_iter = 1000,
  max_iter = 100,
  power_iter = 100,
  tol = 1e-05,
  eta_h = 0.1,
  verbose = TRUE,
  energy_tol = 1e-04,
  seed = 123,
  scores = c("regression", "none", "Bartlett"),
  ...
)
}
\arguments{
\item{data}{Optional raw data matrix. If provided, correlation matrix R is computed from it.}

\item{R}{Optional correlation matrix. If not provided, it is computed from data.}

\item{nfactors}{Number of factors to extract.}

\item{rotate}{Rotation method: "none", "varimax", "promax", or "oblimin".}

\item{nsa_w}{Target regularization strength (w); annealed if anneal_w=TRUE.}

\item{anneal_w}{Logical; whether to anneal w from 0 to nsa_w over iterations.}

\item{nsa_max_iter}{Maximum iterations for NSA-flow.}

\item{max_iter}{Maximum outer iterations.}

\item{power_iter}{Number of power iterations for initial basis estimation.}

\item{tol}{Convergence tolerance for energy change and delta h2.}

\item{eta_h}{Damping factor for communality updates (default 0.1 for slower updates).}

\item{verbose}{Logical; print progress messages.}

\item{energy_tol}{Absolute energy tolerance for convergence.}

\item{seed}{Random seed for reproducibility.}

\item{scores}{Method for factor scores: "regression", "none", or "Bartlett".}

\item{...}{Additional arguments passed to nsa_flow.}
}
\value{
A list of class "nsa_flow_fa" containing:
  \item{loadings}{Final factor loadings matrix.}
  \item{communalities}{Communality estimates (h2).}
  \item{uniqueness}{Uniqueness estimates (1 - h2).}
  \item{converged}{Logical; whether convergence was achieved.}
  \item{iterations}{Number of iterations performed.}
  \item{energy_trace}{Vector of energy values over iterations.}
  \item{factor_scores}{Optional factor scores matrix.}
  \item{nsa_result}{Final NSA-flow result (if successful).}
  \item{best_energy}{Best (lowest) energy achieved.}
  \item{rotation}{Rotation method used.}
  \item{Phi}{Factor correlation matrix (for oblique rotations).}
}
\description{
Factor Analysis (FA) with NSA-Flow regularization.
It uses power iteration to estimate initial loadings, then applies NSA-Flow for regularization (e.g., sparsity via soft-thresholding).
Assumes nsa_flow is an external function that performs non-smooth optimization flow with soft_polar retraction for L1-like regularization.
Includes incremental updating of loadings via warm-start Y0 and optional annealing of w (regularization strength).
}
\examples{
\dontrun{
data(bfi)
bfi_data <- bfi[, 1:25] \%>\% na.omit()
result <- nsa_flow_fa(data = bfi_data, nfactors = 5, rotate = "varimax")
print(result$loadings)
}

}
