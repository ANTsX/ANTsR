% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{compute_communalities}
\alias{compute_communalities}
\title{Compute Communalities from Factor Scores}
\usage{
compute_communalities(data, scores)
}
\arguments{
\item{data}{Numeric matrix or data.frame with n rows (observations) and p
columns (variables).}

\item{scores}{Numeric matrix of factor scores with n rows and k columns
(factors).}
}
\value{
A named numeric vector of length p containing the communalities for
  each variable, named by the column names of \code{data} (if available).
}
\description{
This function calculates the communality for each variable in the dataset,
defined as the proportion of variance explained by the factor scores (R² from
multiple linear regression of each variable on the scores). It provides an
empirical estimate of how much each variable's variance is accounted for by
the common factors. The function assumes the data is centered or standardized
as appropriate for factor analysis.
}
\details{
For each variable, a linear model is fit: \code{lm(data[, i] ~ scores)}, and
the R² is extracted. This aligns with model-based communalities in factor
analysis for large samples but may slightly overestimate due to in-sample
fitting. For efficiency with large p, consider matrix-based alternatives, but
this loop-based approach is simple and leverages base R.
}
\examples{
\dontrun{
# Synthetic data example
set.seed(42)
n <- 100; p <- 5; k <- 2
scores <- matrix(rnorm(n * k), n, k)
loadings <- matrix(runif(p * k, 0.5, 0.8), p, k)
data <- scores \%*\% t(loadings) + matrix(rnorm(n * p, sd = 0.5), n, p)
colnames(data) <- paste0("Var", 1:p)
comm <- compute_communalities(data, scores)
print(comm)
}

}
