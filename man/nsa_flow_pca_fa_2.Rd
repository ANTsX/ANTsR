% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{nsa_flow_pca_fa_2}
\alias{nsa_flow_pca_fa_2}
\title{Perform Proximal Gradient Optimization for PCA or Factor Analysis}
\usage{
nsa_flow_pca_fa_2(
  X,
  k,
  lambda = 0.1,
  alpha = 0.01,
  max_iter = 100,
  proximal_type = c("basic", "nsa_flow"),
  w_pca = 1,
  tol = 1e-06,
  grad_tol = 1e-04,
  nsa_flow_fn = NULL,
  verbose = FALSE,
  objective = c("pca", "fa"),
  rotate = c("none", "varimax", "promax", "oblimin"),
  nsa_flow_args = list()
)
}
\arguments{
\item{X}{Numeric matrix of data (n rows observations, p columns variables).}

\item{k}{Integer number of components/factors (1 <= k <= min(n, p)).}

\item{lambda}{Non-negative regularization parameter for L1 sparsity (default 0.1).}

\item{alpha}{Positive initial step size for gradient descent (default 0.01).}

\item{max_iter}{Maximum number of iterations (default 100).}

\item{proximal_type}{Type of proximal operator: "basic" for soft-thresholding or "nsa_flow" for custom (default "basic").}

\item{w_pca}{Positive weight for PCA objective (default 1.0).}

\item{tol}{Tolerance for convergence based on relative change (default 1e-6).}

\item{grad_tol}{Tolerance for gradient norm (default 1e-4).}

\item{nsa_flow_fn}{Function for NSA proximal operator (required if proximal_type = "nsa_flow").}

\item{verbose}{Logical; if TRUE, print iteration progress (default FALSE).}

\item{objective}{Objective: "pca" or "fa" (default "pca").}

\item{rotate}{Rotation method: "none", "varimax", "promax", or "oblimin" (default "none").}

\item{nsa_flow_args}{List of additional arguments for nsa_flow_fn (default list()).}
}
\value{
A list containing:
\itemize{
  \item \code{Y}: Optimized loadings matrix (unrotated).
  \item \code{loadings}: Final loadings (possibly rotated).
  \item \code{communalities}: Vector of communalities for each variable.
  \item \code{energy_trace}: Vector of energy values per iteration.
  \item \code{final_iter}: Number of iterations performed.
  \item \code{best_energy}: Best (lowest) energy achieved.
  \item \code{converged}: Logical indicating convergence.
  \item \code{no_improve_count}: Count of iterations without improvement.
  \item \code{lr_reductions}: Number of learning rate reductions.
  \item \code{expl_var_ratio}: Explained variance ratio (PCA-style).
}
}
\description{
This function implements a proximal gradient descent algorithm for either
Principal Component Analysis (PCA) or Factor Analysis (FA), with support for
sparsity via L1 regularization or custom proximal operators (e.g., NSA flow).
For PCA, it maximizes explained variance; for FA, it minimizes the least-squares
reconstruction error of the covariance matrix using an alternating optimization
over loadings and uniquenesses. Initialization uses SVD, and optional rotation
is applied at the end.
}
\examples{
\dontrun{
data(iris)
X <- as.matrix(iris[, 1:4])
res <- nsa_flow_pca_fa_2(X, k = 2, objective = "fa", verbose = TRUE)
print(res$loadings)
}

}
