% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/multiscaleSVDxpts.R
\name{nsa_flow_pca_fa}
\alias{nsa_flow_pca_fa}
\title{NSA-Flow Sparse PCA or FA}
\usage{
nsa_flow_pca_fa(
  X,
  k,
  lambda = 0.1,
  alpha = 0.01,
  max_iter = 100,
  proximal_type = c("basic", "nsa_flow"),
  w_pca = 1,
  tol = 1e-06,
  grad_tol = 1e-04,
  nsa_flow_fn = NULL,
  verbose = FALSE,
  objective = c("pca", "fa"),
  rotate = c("none", "varimax", "promax", "oblimin"),
  nsa_flow_args = list()
)
}
\arguments{
\item{X}{numeric matrix (n x p), rows = observations, cols = variables}

\item{k}{integer > 0 and <= min(n,p), number of components}

\item{lambda}{non-negative numeric, L1 proximal weight}

\item{alpha}{positive numeric, initial step size}

\item{max_iter}{integer, maximum iterations}

\item{proximal_type}{character, "basic" or "nsa_flow"}

\item{w_pca}{positive numeric, weight for PCA fidelity}

\item{tol}{numeric, tolerance for relative parameter change convergence}

\item{grad_tol}{numeric, gradient-norm tolerance for convergence}

\item{nsa_flow_fn}{optional, nsa_flow function to use (default: nsa_flow)}

\item{verbose}{logical, print iteration diagnostics}

\item{objective}{character, either "pca" (default) or "fa".
If "fa", the function optimizes a FA-like loss: reconstructing the
sample covariance R with Y Y^T + diag(psi) where psi >= 0 is set
to the diagonal of R - Y Y^T (clipped to a small positive eps).}

\item{rotate}{character; one of "none","varimax","promax","oblimin".
If not "none", the loadings are rotated every iteration (keeps shapes).}

\item{nsa_flow_args}{list, optional additional args forwarded to nsa_flow_fn()}
}
\value{
list with components:
  Y, energy_trace, final_iter, best_energy, converged,
  no_improve_count, lr_reductions, expl_var_ratio
}
\description{
Optimize either a PCA objective (default) or a Factor Analysis (FA) objective
in a single call.  Armijo backtracking, optional NSA-flow proximal,
adaptive LR scheduling, and optional rotation every iteration.
}
