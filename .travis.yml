# Sample .travis.yml for R projects from https://github.com/craigcitro/r-travis

language: c

compiler:
  # - gcc # it fails because of travis limited memory
  - clang

os:
  - linux
  - osx

before_install:
  - cd ..
  - basedir=${PWD}
  - curl -OL http://raw.github.com/craigcitro/r-travis/master/scripts/travis-tool.sh
  - chmod 755 ./travis-tool.sh
  - ./travis-tool.sh bootstrap
  - mkdir -p ~/.R
  - export CC=clang
  - export CXX=clang++
  - echo "CC=clang" >  ~/.R/Makevars
  - echo "CXX=clang++" >> ~/.R/Makevars
  - source ~/.R/Makevars

install:
  - ./travis-tool.sh install_github RcppCore/Rcpp
  - cd ${basedir}

script:
  - travis_retry R CMD build ANTsR && R CMD check ANTsR_1.0.tar.gz --no-manual --as-cran && Rscript -e 'library(ANTsR); fi<-antsImageRead( getANTsRData("r16") ,2); mi<-antsImageRead( getANTsRData("r64") ,2)' -e 'antsRegistration(fixed=fi , moving=mi ,typeofTransform = c("SyN"))'

after_failure:
  - ./travis-tool.sh dump_logs

notifications:
  email:
    recipients:
      - stnava@gmail.com
    on_success: change # default: change
    on_failure: always # default: always

env:
  global:
    - R_BUILD_ARGS="--no-build-vignettes "
    - R_CHECK_ARGS="--no-build-vignettes --timings"
    - R_CHECK_TIME="TRUE"
    - R_CHECK_TESTS="TRUE"
    - _R_CHECK_TIMINGS_="0"
