<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Antsr by stnava</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Antsr</h1>
        <p>...</p>
        <p class="view"><a href="https://github.com/stnava/ANTsR">View the Project on GitHub <small>stnava/ANTsR</small></a></p>
        <ul>
          <li><a href="https://github.com/stnava/ANTsR/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/stnava/ANTsR/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/stnava/ANTsR">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="antsr" class="anchor" href="#antsr" aria-hidden="true"><span class="octicon octicon-link"></span></a>ANTsR</h1>

<p>An R package providing <a href="http://stnava.github.io/ANTs/">ANTs</a> and <a href="https://github.com/InsightSoftwareConsortium/ITK">ITK</a> features in R.</p>

<p>Authors: Shrinidhi KL,  Avants BB</p>

<h2>
<a id="easiest-installation-approach--from-within-r-" class="anchor" href="#easiest-installation-approach--from-within-r-" aria-hidden="true"><span class="octicon octicon-link"></span></a>easiest installation approach ( from within R )</h2>

<pre><code>library( devtools )
install_github("stnava/ANTsR")
</code></pre>

<p>this assumes you have <a href="http://www.cmake.org/download/">cmake</a> installed / accessible in your environment</p>

<p>windows users should see <a href="https://github.com/talgalili/installr">https://github.com/talgalili/installr</a> for assistance in setting up their environment for building (must have a compiler too)</p>

<h2>
<a id="installation-from-source" class="anchor" href="#installation-from-source" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation from source</h2>

<p>see <a href="http://stnava.github.io/software/2014/01/08/antsr/">install from source</a></p>

<p>First, clone the repository:</p>

<div class="highlight highlight-sh"><pre>$ git clone https://github.com/stnava/ANTsR.git</pre></div>

<p>Install the package as follows:</p>

<div class="highlight highlight-sh"><pre>$ R CMD INSTALL ANTsR</pre></div>

<h3>
<a id="binaries" class="anchor" href="#binaries" aria-hidden="true"><span class="octicon octicon-link"></span></a>Binaries</h3>

<p>These are still under development; use at your own discretion.</p>

<ul>
<li><a href="https://dl.dropboxusercontent.com/u/9717050/ANTsR_osx_1.0.tgz">Mac OS X</a></li>
<li><a href="https://dl.dropboxusercontent.com/u/9717050/ANTsR_1.0_R_x86_64-redhat-linux-gnu.tar.gz">RHEL</a></li>
<li><a href="https://dl.dropboxusercontent.com/u/9717050/ANTsR_1.0_R_x86_64-pc-linux-gnu.tar.gz">Other Linux</a></li>
</ul>

<h3>
<a id="r-dependencies" class="anchor" href="#r-dependencies" aria-hidden="true"><span class="octicon octicon-link"></span></a>R dependencies</h3>

<p>You may need to install R packages that ANTsR requires. For example:</p>

<pre><code>install.packages(pkgs = c("Rcpp", "signal", "timeSeries", "mFilter", "doParallel", "robust", "magic", "knitr", "pixmap", "rgl", "misc3d"), dependencies = TRUE);
</code></pre>

<p>These dependencies are subject to change until development is stable.</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Load the package:</p>

<pre><code>library(ANTsR)
</code></pre>

<p>List the available functions in the namespace ANTsR:</p>

<pre><code>ANTsR::&lt;double-tab&gt;
</code></pre>

<p>Call help on a function via ?functionName or see function arguments
via  <code>args(functionName)</code></p>

<h2>
<a id="overview-of-antsr-functionality-and-useful-tools" class="anchor" href="#overview-of-antsr-functionality-and-useful-tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Overview of ANTsR functionality and useful tools</h2>

<p>If nothing else, ANTsR makes it easy to read and write medical images
and to map them into a format compatible with R.</p>

<p><strong>Read, write, access an image</strong></p>

<pre><code>mnifilename&lt;-getANTsRData("mni")
dimension&lt;-3
img&lt;-antsImageRead(mnifilename,dimension)
antsImageWrite(img,mnifilename)
antsGetSpacing(img)
antsGetDirection(img)
antsGetOrigin(img)
print(antsGetPixels(img,50,60,44))
print(max(img))
</code></pre>

<p><strong>Index an image with a label</strong></p>

<pre><code>gaussimg&lt;-array( data=rnorm(125), dim=c(5,5,5))
arrayimg&lt;-array( data=(1:125), dim=c(5,5,5))
img&lt;-as.antsImage( arrayimg )
print( max(img) )
print( mean(img[ img &gt; 50  ]))
print( max(img[ img &gt;= 50 &amp; img &lt;= 99  ]))
print( mean( gaussimg[ img &gt;= 50 &amp; img &lt;= 99  ]) )
</code></pre>

<p><strong>Convert a 4D image to a matrix</strong></p>

<pre><code>gaussimg&lt;-array( data=rnorm(125*10), dim=c(5,5,5,10))
gaussimg&lt;-as.antsImage(gaussimg)
print(dim(gaussimg))
mask&lt;-getAverageOfTimeSeries( gaussimg )
voxelselect &lt;- mask &lt; 0
mask[ voxelselect  ]&lt;-0
mask[ !voxelselect  ]&lt;-1
gmat&lt;-timeseries2matrix( gaussimg, mask )
print(dim(gmat))
</code></pre>

<p><strong>Convert a list of images to a matrix</strong></p>

<pre><code>nimages&lt;-100
ilist&lt;-list()
for ( i in 1:nimages )
{
  simimg&lt;-array( data=rnorm(2500), dim=c(50,50))
  simimg&lt;-as.antsImage( simimg )
  SmoothImage(simimg,1.5,simimg)
  ilist[i]&lt;-simimg
}
# get a mask from the first image
mask&lt;-getMask( ilist[[1]],
  lowThresh=mean(ilist[[1]]), cleanup=TRUE )
mat&lt;-imageListToMatrix( ilist, mask )
print(dim(mat))
</code></pre>

<p><strong>Do fast statistics on a big matrix</strong></p>

<pre><code>mat&lt;-imageListToMatrix( ilist, mask )
age&lt;-rnorm( nrow(mat) ) # simulated age
gender&lt;-rep( c("F","M"), nrow(mat)/2 ) # simulated gender
# this creates "real" but noisy effects to detect
mat&lt;-mat*(age^2+rnorm(nrow(mat)))
mdl&lt;-lm( mat ~ age + gender )
mdli&lt;-bigLMStats( mdl, 1.e-4 )
print(names(mdli))
print(rownames(mdli$beta.t))
print(paste("age",min(p.adjust(mdli$beta.pval[1,]))))
print(paste("gen",min(p.adjust(mdli$beta.pval[2,]))))
</code></pre>

<p><strong>Write out a statistical map</strong></p>

<pre><code>agebetas&lt;-antsImageClone( mask )
agebetas[ mask == 1 ]&lt;-mdli$beta.t[1,]
antsImageWrite( agebetas, 'agebetas.nii.gz' )
</code></pre>

<p>**Neighborhood operations</p>

<pre><code>mnit&lt;-getANTsRData("mni")
mnit&lt;-antsImageRead(mnit,3)
ResampleImageBySpacing(3,mnit,mnit,4,4,4)
mask&lt;-getMask(mnit,lowThresh=mean(mnit),cleanup=TRUE)
radius &lt;- rep(2,mnit@dimension)
mat&lt;-antsGetNeighborhoodMatrix(mnit,mask,radius,
  physical.coordinates = FALSE,
  boundary.condition = "mean" )
eanat&lt;-sparseDecom( mat, mask, 0.05, 20, cthresh=250 )
eseg&lt;-eigSeg(mask,eanat$eig,F)
</code></pre>

<p><strong>Eigenanatomy &amp; SCCAN</strong></p>

<pre><code>?sparseDecom
?sparseDecom2
?initializeEigenanatomy
</code></pre>

<p>See <a href="http://stnava.github.io/sccanTutorial/">sccan tutorial</a></p>

<p><strong>Other useful tools</strong></p>

<pre><code>?ImageMath
?ThresholdImage
# ImageMath(3,threshimg,'ClusterThresholdVariate',threshimg,mask,5)
?antsPreprocessfMRI
?aslPerfusion
?computeDVARS
?getROIValues
?hemodynamicRF
?inspectImageData3D
?makeGraph
?matrixToImages
?plotANTsImage
?antsRegistration
?plotPrettyGraph
?plotBasicNetwork
?getTemplateCoordinates
?antsSet*
</code></pre>

<p>for more fMRI focused tools, see <a href="http://stnava.github.io/RKRNS/">RKRNS</a> and its
github site <a href="https://github.com/stnava/RKRNS">github RKRNS</a>.</p>

<h2>
<a id="direct-access-to-ants-tools" class="anchor" href="#direct-access-to-ants-tools" aria-hidden="true"><span class="octicon octicon-link"></span></a>Direct access to ANTs tools</h2>

<p>Alternatively, one can use any function in the namespace by providing arguments exactly same as one provides to the corresponding command-line version.</p>

<p>For example, to call the antsRegistration routine:</p>

<pre><code>ANTsR::antsRegistration( "-d", "2", "-m", "mi[r16slice.nii.gz,r64slice.nii.gz,1,20,Regular,0.05]", "-t", "affine[1.0]", "-c", "2100x1200x1200x0", "-s", "3x2x1x0", "-f", "4x3x2x1","-u", "1", "-o", "[xtest,xtest.nii.gz,xtest_inv.nii.gz]" )

ANTsR::antsRegistration( "-d", "2", "-m", "mi[r16slice.nii.gz,r64slice.nii.gz,1,20,Regular,0.05]", "-t", "affine[1.0]", "-c", "2100x1200x1200x0", "-s", "3x2x1x0", "-f", "4x3x2x1", "-m", "cc[r16slice.nii.gz,r64slice.nii.gz,1,4]", "-t", "syn[5.0,3,0.0]", "-i", "100x100x0", "-s", "2x1x0", "-f", "3x2x1", "-u", "1", "-o", "[xtest,xtest.nii.gz,xtest_inv.nii.gz]" )
</code></pre>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/stnava">stnava</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>