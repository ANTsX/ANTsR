<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>simlr_interpretation • ANTsR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="simlr_interpretation">
<meta property="og:description" content="ANTsR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/simlr_interpretation.html">simlr_interpretation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>simlr_interpretation</h1>
            
      
      
      <div class="hidden name"><code>simlr_interpretation.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="similarity-driven-multi-view-linear-reconstruction">Similarity-driven multi-view linear reconstruction<a class="anchor" aria-label="anchor" href="#similarity-driven-multi-view-linear-reconstruction"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Similarity-driven multi-view linear reconstruction (SiMLR) is an
algorithm that exploits inter-modality relationships to transform large
scientific datasets into a smaller joint space. The link between the
original data <span class="math inline">\(X_i\)</span> (<span class="math inline">\(n \times p\)</span>) and the reduced embedding
space is a sparse set of features <span class="math inline">\(v_i\)</span> ( <span class="math inline">\(p
\times k\)</span> ). Standard statistical tools may then be applied on
the embeddings <span class="math inline">\(s_i=X_i v_i\)</span>.</p>
<p>SiMLR may be used in a variety of other ways. We will cover a basic
example and follow with different use cases. These examples are perhaps
less involved than those given in the <a href="https://www.nature.com/articles/s43588-021-00029-8" class="external-link">original
publication’s</a> cloud computing <a href="https://doi.org/10.24433/CO.3087836.v2" class="external-link">examples</a> but
illustrate new functionality.</p>
</div>
<div class="section level3">
<h3 id="example-applying-simlr-to-simulated-multi-view-data">Example: Applying SiMLR to Simulated Multi-View Data<a class="anchor" aria-label="anchor" href="#example-applying-simlr-to-simulated-multi-view-data"></a>
</h3>
<p>In this section, we explore how SiMLR can be applied to multi-view
datasets. We’ll generate synthetic data to simulate the application of
SiMLR, compare the results to traditional methods like Singular Value
Decomposition (SVD), and visualize the relationships between the views.
This example derives from the simulation-based evaluation in the
original paper.</p>
<div class="section level4">
<h4 id="step-1-simulate-multi-view-data">Step 1: Simulate Multi-View Data<a class="anchor" aria-label="anchor" href="#step-1-simulate-multi-view-data"></a>
</h4>
<p>We begin by simulating three different views of data, each
representing different modalities or datasets that share some underlying
structure.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ANTsR</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'stats::filter' by 'dplyr::filter' when</span></span>
<span><span class="co">#&gt; loading 'ANTsR'</span></span>
<span><span class="co">#&gt; ANTsR 0.6.1</span></span>
<span><span class="co">#&gt; Environment variables set either in .Renviron or with a seed (e.g. XXX): </span></span>
<span><span class="co">#&gt; Sys.setenv(ANTS_RANDOM_SEED = XXX)</span></span>
<span><span class="co">#&gt; Sys.setenv(ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS = 1)</span></span>
<span><span class="co">#&gt; may influence reproducibility in some methods. See</span></span>
<span><span class="co">#&gt; https://github.com/ANTsX/ANTs/wiki/antsRegistration-reproducibility-issues</span></span>
<span><span class="co">#&gt; for more information.Also see *repro methods in antsRegistration.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'ANTsR'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     sd, var</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     all, any, apply, max, min, prod, range, sum</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1500</span><span class="op">)</span></span>
<span><span class="va">nsub</span> <span class="op">&lt;-</span> <span class="fl">100</span>          <span class="co"># Number of subjects/samples</span></span>
<span><span class="va">npix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">133</span><span class="op">)</span>  <span class="co"># Number of features in each view</span></span>
<span><span class="va">nk</span> <span class="op">&lt;-</span> <span class="fl">5</span>             <span class="co"># Number of latent factors</span></span>
<span></span>
<span><span class="co"># Generating outcome matrices for each view</span></span>
<span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span><span class="va">outcome1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span><span class="va">outcome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span><span class="va">outcome3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generating transformation matrices for each view</span></span>
<span><span class="va">view1tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span><span class="va">view2tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span><span class="va">view3tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating the multi-view data matrices</span></span>
<span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view1tx</span></span>
<span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view2tx</span></span>
<span><span class="va">mat3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome3</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view3tx</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"m1."</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"m2."</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat3</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"m3."</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the matrices into a list</span></span>
<span><span class="va">matlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="va">mat1</span>, m2 <span class="op">=</span> <span class="va">mat2</span>, m3 <span class="op">=</span> <span class="va">mat3</span><span class="op">)</span></span></code></pre></div>
<p>In this code, <code>mat1</code>, <code>mat2</code>, and
<code>mat3</code> represent three views of the data. Each view is
constructed to share a common underlying structure but with different
transformations applied.</p>
</div>
<div class="section level4">
<h4 id="step-2-apply-simlr">Step 2: Apply SiMLR<a class="anchor" aria-label="anchor" href="#step-2-apply-simlr"></a>
</h4>
<p>Now we apply the SiMLR algorithm to the simulated multi-view data to
find a common representation across the views.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Applying SiMLR</span></span>
<span><span class="va">constr</span><span class="op">=</span><span class="st">'Grassmannx1x1'</span></span>
<span><span class="va">constr</span><span class="op">=</span><span class="st">'Stiefelx1x1'</span></span>
<span><span class="va">constr</span><span class="op">=</span><span class="st">'orthox0.1x0.1'</span></span>
<span><span class="va">prepro</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"centerAndScale"</span>,<span class="st">"np"</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simlr.html">simlr</a></span><span class="op">(</span><span class="va">matlist</span>,constraint<span class="op">=</span><span class="va">constr</span>,scale<span class="op">=</span><span class="va">prepro</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ortho" "0.1"   "0.1"  </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.897019799238767  &lt;o&gt; mixer: svd  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.253280672320863 bestIt: 1 CE: -0.253280672320863"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.404583596933736 bestIt: 2 CE: -0.404583596933736"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.810491744310403 bestIt: 3 CE: -0.810491744310403"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.8193484051941 bestIt: 4 CE: -0.8193484051941"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.8193484051941 bestIt: 4 CE: -0.766879419521874"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.8193484051941 bestIt: 4 CE: -0.769814132925513"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.8193484051941 bestIt: 4 CE: -0.671251201612116"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.8193484051941 bestIt: 4 CE: -0.697501085762956"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.8193484051941 bestIt: 4 CE: -0.62642418606143"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.8193484051941 bestIt: 4 CE: -0.795599051601249"</span></span>
<span></span>
<span><span class="co"># Projecting data into the reduced space</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">mat1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">mat2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">mat3</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>SiMLR identifies a sparse set of features that best reconstruct each
view, resulting in projections <code>p1</code>, <code>p2</code>, and
<code>p3</code> for each view.</p>
</div>
<div class="section level4">
<h4 id="step-3-visualization-and-comparison">Step 3: Visualization and Comparison<a class="anchor" aria-label="anchor" href="#step-3-visualization-and-comparison"></a>
</h4>
<p>To understand the effectiveness of the SiMLR projections, we can
compare the correlations between the projections of different views.
Additionally, we’ll compare the results to those obtained via Singular
Value Decomposition (SVD).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate SVD for comparison</span></span>
<span><span class="va">svd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat1</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span>
<span><span class="va">svd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat2</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span>
<span><span class="va">svd3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat3</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span>
<span></span>
<span><span class="co"># Calculate correlations between the SiMLR projections</span></span>
<span><span class="va">cor_p1_p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_p1_p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_p2_p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p2</span>, <span class="va">p3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare with correlations from SVD</span></span>
<span><span class="va">cor_svd1_svd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">svd1</span>, <span class="va">svd2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between p1 and p2:"</span>, <span class="va">cor_p1_p2</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation between p1 and p2: -0.9786008 0.4360317</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between p1 and p3:"</span>, <span class="va">cor_p1_p3</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation between p1 and p3: -0.9909754 0.5789666</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between p2 and p3:"</span>, <span class="va">cor_p2_p3</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation between p2 and p3: -0.5314355 0.9941934</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Correlation between SVD1 and SVD2:"</span>, <span class="va">cor_svd1_svd2</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Correlation between SVD1 and SVD2: -0.834545 0.5642089</span></span></code></pre></div>
<div class="section level5">
<h5 id="visualizing-correlations">Visualizing Correlations<a class="anchor" aria-label="anchor" href="#visualizing-correlations"></a>
</h5>
<p>Visualizing these correlations helps us understand the similarity
between the views after the SiMLR transformation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.3.1</span></span>
<span></span>
<span><span class="co"># Function to plot correlation heatmaps</span></span>
<span><span class="va">plot_cor_heatmap</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mat1</span>, <span class="va">mat2</span>, <span class="va">title</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cor_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat1</span>,<span class="va">mat2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">cor_mat</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Var1</span>, <span class="va">Var2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient2</a></span><span class="op">(</span>midpoint <span class="op">=</span> <span class="fl">0.5</span>, low <span class="op">=</span> <span class="st">"blue"</span>, high <span class="op">=</span> <span class="st">"red"</span>, mid <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="va">title</span>, x <span class="op">=</span> <span class="st">"Variables"</span>, y <span class="op">=</span> <span class="st">"Variables"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plotting the correlations</span></span>
<span><span class="fu">plot_cor_heatmap</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="st">"Correlation Heatmap of p1-p2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/stepviz-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_cor_heatmap</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p3</span>,<span class="st">"Correlation Heatmap of p1-p3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/stepviz-2.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_cor_heatmap</span><span class="op">(</span><span class="va">p2</span>, <span class="va">p3</span>, <span class="st">"Correlation Heatmap of p2-p3"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/stepviz-3.png" width="700"></p>
<p>These heatmaps show how the reduced representations from SiMLR
correlate within each view. Comparing these with similar plots for SVD
will reveal whether SiMLR captures more meaningful relationships between
the views.</p>
</div>
</div>
<div class="section level4">
<h4 id="step-4-permutation-test">Step 4: Permutation Test<a class="anchor" aria-label="anchor" href="#step-4-permutation-test"></a>
</h4>
<p>A permutation test can assess whether the observed correlations are
significant.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span></span>
<span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span></span>
<span><span class="va">permMats</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vox <span class="op">=</span> <span class="va">mat1</span>, vox2 <span class="op">=</span> <span class="va">mat2</span><span class="op">[</span><span class="va">s1</span>, <span class="op">]</span>, vox3 <span class="op">=</span> <span class="va">mat3</span><span class="op">[</span><span class="va">s2</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="va">resultp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simlr.html">simlr</a></span><span class="op">(</span><span class="va">permMats</span>,</span>
<span>  constraint<span class="op">=</span><span class="va">constr</span>,scale<span class="op">=</span><span class="va">prepro</span><span class="op">)</span></span>
<span><span class="va">p1p</span> <span class="op">&lt;-</span> <span class="va">mat1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p2p</span> <span class="op">&lt;-</span> <span class="va">mat2</span><span class="op">[</span><span class="va">s1</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">p3p</span> <span class="op">&lt;-</span> <span class="va">mat3</span><span class="op">[</span><span class="va">s2</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare the permuted correlations</span></span>
<span><span class="va">cor_p1p_p2p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1p</span>, <span class="va">p2p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_p1p_p3p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1p</span>, <span class="va">p3p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cor_p2p_p3p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p2p</span>, <span class="va">p3p</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print permuted results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Permuted Correlation between p1p and p2p:"</span>, <span class="va">cor_p1p_p2p</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Permuted Correlation between p1p and p2p: -0.283758 0.0637503</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Permuted Correlation between p1p and p3p:"</span>, <span class="va">cor_p1p_p3p</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Permuted Correlation between p1p and p3p: -0.1339851 0.1661104</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Permuted Correlation between p2p and p3p:"</span>, <span class="va">cor_p2p_p3p</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Permuted Correlation between p2p and p3p: -0.3204276 0.335416</span></span></code></pre></div>
<p>The permutation test will show if the observed correlations are
stronger than those expected by chance.</p>
<p>This introductory example demonstrates how SiMLR can uncover the
shared structure across multiple views of data. The correlations between
the projections indicate the degree to which the algorithm has captured
this shared structure, and the permutation test serves as a validation
step.</p>
</div>
</div>
<div class="section level3">
<h3 id="integration-of-multiple-data-types-via-dimensionality-reduction">Integration of Multiple Data Types via Dimensionality Reduction<a class="anchor" aria-label="anchor" href="#integration-of-multiple-data-types-via-dimensionality-reduction"></a>
</h3>
<p>SiMLR is particularly useful when working with datasets from
different modalities (e.g., genomics, proteomics, and imaging data). By
finding a joint embedding space, SiMLR can integrate these diverse data
types into a unified representation, facilitating downstream analyses
such as clustering, classification, or regression.</p>
<p>When dealing with high-dimensional data, dimensionality reduction
techniques are often required to make the data more manageable and to
avoid issues like the curse of dimensionality. SiMLR provides an
approach that not only reduces dimensionality but also maintains the
relationships between different views of the data, making it a powerful
tool for exploratory data analysis and visualization. Below, we
illustrate reading, writing and exploratory integrated
visualization.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.unibo.it/sitoweb/christian.hennig/en/" class="external-link">fpc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="va">sim2nm</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/write_simlr_data_frames.html">write_simlr_data_frames</a></span><span class="op">(</span> <span class="va">result</span><span class="op">$</span><span class="va">v</span>, <span class="va">sim2nm</span>  <span class="op">)</span></span>
<span><span class="va">simres2</span><span class="op">=</span><span class="fu"><a href="../reference/read_simlr_data_frames.html">read_simlr_data_frames</a></span><span class="op">(</span> <span class="va">sim2nm</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">popdf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> age <span class="op">=</span> <span class="va">outcome</span>, cog<span class="op">=</span><span class="va">outcome1</span>, <span class="va">mat1</span>, <span class="va">mat2</span>, <span class="va">mat3</span> <span class="op">)</span></span>
<span><span class="va">temp2</span><span class="op">=</span><span class="fu"><a href="../reference/apply_simlr_matrices.html">apply_simlr_matrices</a></span><span class="op">(</span> <span class="va">popdf</span>, <span class="va">simres2</span>, </span>
<span>    center<span class="op">=</span><span class="cn">TRUE</span>, scale<span class="op">=</span><span class="cn">TRUE</span>, absolute_value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">simnames</span><span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">zz</span><span class="op">=</span><span class="fu"><a href="../reference/exploratory_visualization.html">exploratory_visualization</a></span><span class="op">(</span> <span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="va">temp2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">]</span>, dotsne<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: package 'GGally' was built under R version 4.3.1</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; Warning: package 'ggdendro' was built under R version 4.3.1</span></span>
<span><span class="co">#&gt; Warning: package 'patchwork' was built under R version 4.3.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">zz</span><span class="op">$</span><span class="va">plot</span> <span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/dataintegration-1.png" width="1152"></p>
<p>Now we can icorporate the “modalities” in order to predict the
simulated outcome matrix. Note that contributions exist from each
modality in the regression (in some cases). This is one of the
advantages of SiMLR: it provides systematic guidance for building these
types of integrative models.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># multi-view regression</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">age.1</span> <span class="op">~</span> <span class="va">m1PC1</span> <span class="op">+</span> <span class="va">m2PC1</span> <span class="op">+</span> <span class="va">m3PC1</span>, data<span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = age.1 ~ m1PC1 + m2PC1 + m3PC1, data = temp2[[1]])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.87692 -0.44257  0.08478  0.46614  1.74734 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.06104    0.07252   0.842    0.402    </span></span>
<span><span class="co">#&gt; m1PC1       -0.14758    0.21113  -0.699    0.486    </span></span>
<span><span class="co">#&gt; m2PC1       -1.07477    0.13620  -7.891 4.83e-12 ***</span></span>
<span><span class="co">#&gt; m3PC1       -1.69287    0.33952  -4.986 2.73e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.7252 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.5191, Adjusted R-squared:  0.5041 </span></span>
<span><span class="co">#&gt; F-statistic: 34.54 on 3 and 96 DF,  p-value: 3.137e-15</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">age.2</span> <span class="op">~</span> <span class="va">m1PC1</span> <span class="op">+</span> <span class="va">m2PC1</span> <span class="op">+</span> <span class="va">m3PC1</span>, data<span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = age.2 ~ m1PC1 + m2PC1 + m3PC1, data = temp2[[1]])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.98779 -0.46277 -0.01922  0.52706  1.76221 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept) -0.06212    0.07047  -0.881  0.38028   </span></span>
<span><span class="co">#&gt; m1PC1        0.53952    0.20515   2.630  0.00995 **</span></span>
<span><span class="co">#&gt; m2PC1       -0.20935    0.13235  -1.582  0.11698   </span></span>
<span><span class="co">#&gt; m3PC1        0.04453    0.32991   0.135  0.89291   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.7047 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.4669, Adjusted R-squared:  0.4502 </span></span>
<span><span class="co">#&gt; F-statistic: 28.03 on 3 and 96 DF,  p-value: 4.2e-13</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">age.3</span> <span class="op">~</span> <span class="va">m1PC1</span> <span class="op">+</span> <span class="va">m2PC1</span> <span class="op">+</span> <span class="va">m3PC1</span>, data<span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = age.3 ~ m1PC1 + m2PC1 + m3PC1, data = temp2[[1]])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.14340 -0.31062 -0.00963  0.27818  1.03336 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.03258    0.04689   0.695   0.4888    </span></span>
<span><span class="co">#&gt; m1PC1        0.23151    0.13650   1.696   0.0931 .  </span></span>
<span><span class="co">#&gt; m2PC1        1.06898    0.08806  12.140  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; m3PC1        1.33673    0.21951   6.090 2.33e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.4689 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7866, Adjusted R-squared:   0.78 </span></span>
<span><span class="co">#&gt; F-statistic:   118 on 3 and 96 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">age.4</span> <span class="op">~</span> <span class="va">m1PC1</span> <span class="op">+</span> <span class="va">m2PC1</span> <span class="op">+</span> <span class="va">m3PC1</span>, data<span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = age.4 ~ m1PC1 + m2PC1 + m3PC1, data = temp2[[1]])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -1.28560 -0.30096  0.06679  0.33574  0.88247 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  0.02380    0.04615   0.516    0.607    </span></span>
<span><span class="co">#&gt; m1PC1        2.42044    0.13434  18.017   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; m2PC1        1.04513    0.08667  12.059   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; m3PC1        3.92198    0.21604  18.154   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.4615 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.7894, Adjusted R-squared:  0.7828 </span></span>
<span><span class="co">#&gt; F-statistic: 119.9 on 3 and 96 DF,  p-value: &lt; 2.2e-16</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">age.5</span> <span class="op">~</span> <span class="va">m1PC1</span> <span class="op">+</span> <span class="va">m2PC1</span> <span class="op">+</span> <span class="va">m3PC1</span>, data<span class="op">=</span><span class="va">temp2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = age.5 ~ m1PC1 + m2PC1 + m3PC1, data = temp2[[1]])</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -1.8581 -0.5587 -0.1209  0.5738  2.1824 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) -0.08199    0.08144  -1.007 0.316557    </span></span>
<span><span class="co">#&gt; m1PC1        0.89302    0.23708   3.767 0.000285 ***</span></span>
<span><span class="co">#&gt; m2PC1       -0.36262    0.15294  -2.371 0.019741 *  </span></span>
<span><span class="co">#&gt; m3PC1        0.48221    0.38125   1.265 0.209006    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8144 on 96 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2809, Adjusted R-squared:  0.2584 </span></span>
<span><span class="co">#&gt; F-statistic:  12.5 on 3 and 96 DF,  p-value: 5.716e-07</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sparse-feature-selection">Sparse Feature Selection<a class="anchor" aria-label="anchor" href="#sparse-feature-selection"></a>
</h3>
<p>SiMLR incorporates sparse feature selection, allowing users to
identify a minimal subset of features that contribute most to the joint
embedding space. This can be particularly advantageous in settings where
interpretability is crucial, such as biomarker discovery in biological
datasets.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp</span><span class="op">=</span><span class="fu"><a href="../reference/plot_features.html">plot_features</a></span><span class="op">(</span> <span class="va">simres2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span> grobs<span class="op">=</span><span class="va">pp</span>, nrow<span class="op">=</span><span class="fl">3</span>, top<span class="op">=</span><span class="st">'Joint features'</span> <span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/featureselection-1.png" width="1152"></p>
<div class="section level4">
<h4 id="improved-model-interpretability">Improved Model Interpretability<a class="anchor" aria-label="anchor" href="#improved-model-interpretability"></a>
</h4>
<p>By projecting the data into a joint space, SiMLR helps improve the
interpretability of machine learning models. The sparse feature
selection ensures that only the most informative features are retained,
making it easier to understand the relationships between the input data
and the model’s predictions.</p>
</div>
</div>
<div class="section level3">
<h3 id="cross-modal-prediction-or-imputation">Cross-Modal Prediction or Imputation<a class="anchor" aria-label="anchor" href="#cross-modal-prediction-or-imputation"></a>
</h3>
<p>In scenarios where you have multiple data modalities but missing
information scattered across some of the views, SiMLR can be used to
impute the missing data by leveraging the relationships between the
available modalities. This cross-modal prediction capability is
particularly useful in multi-omics studies and other fields where
complete data is often unavailable.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">popdfi</span><span class="op">=</span><span class="va">popdf</span></span>
<span><span class="va">proportion</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">num_NAs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">proportion</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">popdfi</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">popdfi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">arrayInd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">popdfi</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">popdfi</span><span class="op">)</span><span class="op">)</span>, <span class="va">num_NAs</span><span class="op">)</span>, .dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">popdfi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">popdfi</span><span class="op">[</span><span class="va">indices</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">nms</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">simres2</span><span class="op">)</span></span>
<span><span class="va">nsimx</span><span class="op">=</span><span class="fl">3</span></span>
<span><span class="va">sep</span><span class="op">=</span><span class="st">'.'</span></span>
<span><span class="va">imputedcols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">n</span> <span class="kw">in</span> <span class="va">nms</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span> <span class="va">v</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">nsimx</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">thiscol</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">sep</span>,<span class="va">v</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="../reference/antsImageSummary.html">any</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span> <span class="va">popdfi</span><span class="op">[</span>,<span class="va">thiscol</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">imputedcols</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">imputedcols</span>,<span class="va">thiscol</span><span class="op">)</span></span>
<span>      <span class="va">popdfi</span> <span class="op">=</span> <span class="fu"><a href="../reference/simlr_impute.html">simlr_impute</a></span><span class="op">(</span> <span class="va">popdfi</span>, <span class="va">nms</span>, <span class="va">v</span>, <span class="va">n</span>, separator<span class="op">=</span><span class="va">sep</span> <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">impresult</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> og<span class="op">=</span><span class="va">popdf</span><span class="op">[</span>,<span class="va">imputedcols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, imp<span class="op">=</span><span class="va">popdfi</span><span class="op">[</span>,<span class="va">imputedcols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggscatter.html" class="external-link">ggscatter</a></span><span class="op">(</span> <span class="va">impresult</span>, <span class="st">'og'</span>, <span class="st">'imp'</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Imputed vs original data"</span>,<span class="va">imputedcols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 4 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/imp-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="testing-significance-of-joint-relationships">Testing Significance of Joint Relationships<a class="anchor" aria-label="anchor" href="#testing-significance-of-joint-relationships"></a>
</h3>
<p>We use a metric (<code>rvcoef</code>) that is not directly optimized
to assess the significance of the simlr result versus permuted data. The
RV coefficient is analogous to the Pearson correlation coefficient but
is used for comparing two matrices (or datasets) rather than two
variables. It measures the similarity of the column spaces (subspaces)
spanned by the columns of two matrices. We compute the
<code>rvcoef</code> across all pairs of data at each permutation and
compare to the original values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initu</span> <span class="op">=</span> <span class="fu"><a href="../reference/initializeSimlr.html">initializeSimlr</a></span><span class="op">(</span> <span class="va">matlist</span>, <span class="fl">3</span>, jointReduction <span class="op">=</span> <span class="cn">TRUE</span>  <span class="op">)</span></span>
<span><span class="va">np</span><span class="op">=</span><span class="fl">40</span></span>
<span><span class="va">myperm</span> <span class="op">=</span> <span class="fu"><a href="../reference/simlr.perm.html">simlr.perm</a></span><span class="op">(</span>  <span class="va">matlist</span>,</span>
<span>  constraint<span class="op">=</span><span class="va">constr</span>,scale<span class="op">=</span><span class="va">prepro</span>, </span>
<span>  initialUMatrix<span class="op">=</span><span class="va">initu</span>,</span>
<span>  nperms<span class="op">=</span><span class="va">np</span>, FUN<span class="op">=</span><span class="va">rvcoef</span>, verbose<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ortho" "0.1"   "0.1"  </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.892100113764282  &lt;o&gt; mixer: svd  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.650248428644519 bestIt: 1 CE: -0.650248428644519"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.650248428644519 bestIt: 1 CE: -0.481399800802654"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.650248428644519 bestIt: 1 CE: -0.476248138143961"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.650248428644519 bestIt: 1 CE: -0.471366874761084"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.677821086302228 bestIt: 5 CE: -0.677821086302228"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.838207156514181 bestIt: 6 CE: -0.838207156514181"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.838207156514181 bestIt: 6 CE: -0.784694758842972"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.838207156514181 bestIt: 6 CE: -0.820198645734556"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.838207156514181 bestIt: 6 CE: -0.462077600293351"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.871360670328648 bestIt: 10 CE: -0.871360670328648"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span> <span class="va">myperm</span><span class="op">$</span><span class="va">significance</span>, <span class="fl">2</span> <span class="op">)</span>  <span class="op">)</span></span>
<span><span class="co">#&gt;    n   perm       m1_m2        m1_m3        m2_m3</span></span>
<span><span class="co">#&gt; 42 3  ttest 3.88559e-50 4.317305e-47 1.329116e-52</span></span>
<span><span class="co">#&gt; 43 3 pvalue 0.00000e+00 0.000000e+00 0.000000e+00</span></span>
<span><span class="va">gglist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">simlrmaps</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">myperm</span><span class="op">$</span><span class="va">significance</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">xxx</span> <span class="kw">in</span> <span class="va">simlrmaps</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pvec</span><span class="op">=</span><span class="va">myperm</span><span class="op">$</span><span class="va">significance</span><span class="op">[</span> <span class="va">myperm</span><span class="op">$</span><span class="va">significance</span><span class="op">$</span><span class="va">perm</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">np</span><span class="op">)</span>,<span class="va">xxx</span><span class="op">]</span></span>
<span>    <span class="va">original_tstat</span> <span class="op">&lt;-</span> <span class="va">myperm</span><span class="op">$</span><span class="va">significance</span><span class="op">[</span><span class="fl">1</span>,<span class="va">xxx</span><span class="op">]</span> <span class="co"># replace with actual value</span></span>
<span>    <span class="va">gglist</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gglist</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="op">(</span> <span class="fu"><a href="../reference/visualize_permutation_test.html">visualize_permutation_test</a></span><span class="op">(</span> <span class="va">pvec</span>, <span class="va">original_tstat</span>, <span class="va">xxx</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span> grobs<span class="op">=</span><span class="va">gglist</span>, top<span class="op">=</span><span class="st">'Cross-modality relationships: permutation tested'</span><span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/permutation-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># display simlr results</span></span>
<span><span class="va">gglist2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span> <span class="va">j</span> <span class="kw">in</span> <span class="op">(</span><span class="op">(</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">toviz1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">simres2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">toviz2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">simres2</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">temp</span><span class="op">=</span><span class="fu"><a href="../reference/visualize_lowrank_relationships.html">visualize_lowrank_relationships</a></span><span class="op">(</span> <span class="va">matlist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">matlist</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>, </span>
<span>            <span class="va">toviz1</span>, <span class="va">toviz2</span>,</span>
<span>            nm1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, nm2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">)</span><span class="op">$</span><span class="va">plot</span></span>
<span>        <span class="va">gglist2</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gglist2</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">temp</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs<span class="op">=</span><span class="op">(</span><span class="va">gglist2</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">1</span>, top<span class="op">=</span><span class="st">'Low-rank correlations: SiMLR'</span><span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/permutation2-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="evaluating-machine-learning-objective-functions">Evaluating Machine Learning Objective Functions<a class="anchor" aria-label="anchor" href="#evaluating-machine-learning-objective-functions"></a>
</h3>
<p>This section of the tutorial vignette provides an example of how to
set up and run a parameter search using the simlr.search function. Here,
<code>csearch</code> contains a list of constraint options that include
“none” and different options for enforcing orthogonality <em>in the
feature space</em>. This list will be used to explore different
constraint options during the parameter search.</p>
<p>In this step, the simlr.parameters function is called to create a
parameter list (<code>simparms</code>) that will control the grid
search. Each parameter category (e.g., <code>nsimlr_options</code>,
<code>prescaling_options</code>, etc.) is provided with options as a
list. These parameters specify the settings and constraints that will be
explored during the optimization process.</p>
<ul>
<li><p><code>nsimlr_options</code> : The number of latent factors to
consider.</p></li>
<li><p><code>prescaling_options</code> : Methods for data
scaling/preprocessing (robust, whiten, np).</p></li>
<li><p><code>objectiver_options</code> : The objective function used (eg
regression or cca).</p></li>
<li><p><code>mixer_options</code> : The mixing technique (ica or
pca).</p></li>
<li><p><code>sparval_options</code> : Sparseness settings.</p></li>
<li><p><code>expBeta_options</code> : Exponential smoothing parameter
beta values. e.g. 0.0, 0.9, 0.99, 0.999.</p></li>
<li><p><code>positivities_options</code> : Positivity
constraints.</p></li>
<li><p><code>optimus_options</code> : The optimization strategy
(lineSearch, mixed, greedy).</p></li>
<li><p><code>constraint_options</code> : Feature space orthogonality
constraints to apply.</p></li>
<li><p><code>search_type</code> : The type of search to perform (full
indicates a full grid search).</p></li>
<li><p><code>num_samples</code> : The number of samples to evaluate
during the search.</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">paster</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>, <span class="va">vec2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">vec1</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span><span class="op">)</span>, <span class="va">vec2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">csearch</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, </span>
<span>  <span class="fu">paster</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Grassmannx"</span>,<span class="st">"Stiefelx"</span>,<span class="st">"orthox"</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"10x10"</span>,<span class="st">"1x1"</span>,<span class="st">"0.1x0.1"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># the 10x10 are weights on the optimization term of the energy</span></span>
<span><span class="va">simparms</span> <span class="op">=</span> <span class="fu"><a href="../reference/simlr.parameters.html">simlr.parameters</a></span><span class="op">(</span> </span>
<span>    nsimlr_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fl">2</span> <span class="op">)</span>,</span>
<span>    prescaling_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"robust"</span>, <span class="st">"centerAndScale"</span>,  <span class="st">"np"</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    objectiver_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"cca"</span><span class="op">)</span>,</span>
<span>    mixer_options<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pca"</span><span class="op">)</span>, </span>
<span>    sparval_options<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    expBeta_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.99</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    positivities_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"positive"</span>,<span class="st">"positive"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    optimus_options<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">'lineSearch'</span><span class="op">)</span>,</span>
<span>    constraint_options<span class="op">=</span><span class="va">csearch</span>,</span>
<span>    search_type<span class="op">=</span><span class="st">"full"</span>,</span>
<span>    num_samples<span class="op">=</span><span class="fl">5</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The <code>regularizeSimlr</code> function is used to apply
regularization to the input matrices matlist. Regularization can help
prevent overfitting by penalizing complexity. The fraction and sigma
parameters control the extent and type of regularization.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regs</span> <span class="op">=</span> <span class="fu"><a href="../reference/regularizeSimlr.html">regularizeSimlr</a></span><span class="op">(</span><span class="va">matlist</span>, fraction<span class="op">=</span><span class="fl">0.05</span>, </span>
<span>  sigma<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">regs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/grassmann1-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">regs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p><img src="simlr_interpretation_files/figure-html/grassmann1-2.png" width="700"></p>
<p>The <code>simlr.search</code> function performs the grid search over
the parameter space defined in <code>simparms</code>. It takes the
matrices matlist and regs as input. The <code>nperms</code> specifies
the number of permutations to evaluate for robustness. The
<code>verbose</code> parameter controls the level of detail in the
output during the search process.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simlrXs</span><span class="op">=</span><span class="fu"><a href="../reference/simlr.search.html">simlr.search</a></span><span class="op">(</span></span>
<span>        <span class="va">matlist</span>,</span>
<span>        regs<span class="op">=</span><span class="va">regs</span>,</span>
<span>        <span class="va">simparms</span>,</span>
<span>        nperms<span class="op">=</span><span class="fl">12</span>,</span>
<span>        verbose<span class="op">=</span><span class="fl">4</span></span>
<span>        <span class="op">)</span></span>
<span><span class="co">#&gt; Will search: 10 parameter sets[1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "none"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "none" NA     NA    </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.923787715699613  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.358282079739464 bestIt: 1 CE: -0.358282079739464"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.46883381649157 bestIt: 2 CE: -0.46883381649157"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.796791010129841 bestIt: 3 CE: -0.796791010129841"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.799360419634454 bestIt: 4 CE: -0.799360419634454"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.82885037093229 bestIt: 5 CE: -0.82885037093229"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.82885037093229 bestIt: 5 CE: -0.822009500853158"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.82885037093229 bestIt: 5 CE: -0.822009500853158"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.82885037093229 bestIt: 5 CE: -0.787504380595427"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.831370815904379 bestIt: 9 CE: -0.831370815904379"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.840370229846114 bestIt: 10 CE: -0.840370229846114"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 11 bestEv: -0.840370229846114 bestIt: 10 CE: -0.769701075265139"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 12 bestEv: -0.840370229846114 bestIt: 10 CE: -0.734862687330073"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 13 bestEv: -0.840370229846114 bestIt: 10 CE: -0.734862687330073"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 14 bestEv: -0.840370229846114 bestIt: 10 CE: -0.717707788312638"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 15 bestEv: -0.840370229846114 bestIt: 10 CE: -0.695611170634912"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 16 bestEv: -0.840370229846114 bestIt: 10 CE: -0.675723522545338"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Grassmannx10x10"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Grassmann" "10"        "10"       </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.256180683310025  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.572332138279817 bestIt: 1 CE: -0.572332138279817"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.742869999695666 bestIt: 2 CE: -0.742869999695666"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.742869999695666 bestIt: 2 CE: -0.738929198216032"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Grassmannx1x1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Grassmann" "1"         "1"        </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.857027012460654  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.568063748955966 bestIt: 1 CE: -0.568063748955966"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.6384098624039 bestIt: 2 CE: -0.6384098624039"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.821032892373937 bestIt: 3 CE: -0.821032892373937"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.853348011551356 bestIt: 4 CE: -0.853348011551356"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.853348011551356 bestIt: 4 CE: -0.853348011551356"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.853348011551356 bestIt: 4 CE: -0.8334722954351"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.853348011551356 bestIt: 4 CE: -0.827310232364803"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.853348011551356 bestIt: 4 CE: -0.826230051515903"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.853348011551356 bestIt: 4 CE: -0.784256680859058"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.859872695845605 bestIt: 10 CE: -0.859872695845605"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 11 bestEv: -0.859872695845605 bestIt: 10 CE: -0.859872695845605"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 12 bestEv: -0.859872695845605 bestIt: 10 CE: -0.859872695845605"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 13 bestEv: -0.859872695845605 bestIt: 10 CE: -0.857867514510308"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 14 bestEv: -0.859872695845605 bestIt: 10 CE: -0.857867514510308"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 15 bestEv: -0.859872695845605 bestIt: 10 CE: -0.857867514510308"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 16 bestEv: -0.859872695845605 bestIt: 10 CE: -0.857867514510308"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Grassmannx0.1x0.1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Grassmann" "0.1"       "0.1"      </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.917111645375717  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.395328252193667 bestIt: 1 CE: -0.395328252193667"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.876505321910793 bestIt: 2 CE: -0.876505321910793"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.876505321910793 bestIt: 2 CE: -0.715775124305709"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.876505321910793 bestIt: 2 CE: -0.556572105988905"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.876505321910793 bestIt: 2 CE: -0.704977394581536"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.876505321910793 bestIt: 2 CE: -0.701747921610733"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.876505321910793 bestIt: 2 CE: -0.701644867438938"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.876505321910793 bestIt: 2 CE: -0.712268348974026"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Stiefelx10x10"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Stiefel" "10"      "10"     </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.256180683310025  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.650640207873091 bestIt: 1 CE: -0.650640207873091"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.650640207873091 bestIt: 1 CE: -0.218388179246398"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.696319915034635 bestIt: 3 CE: -0.696319915034635"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.759893913629972 bestIt: 4 CE: -0.759893913629972"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.768262080301378 bestIt: 5 CE: -0.768262080301378"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.768262080301378 bestIt: 5 CE: -0.765977672674105"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.768262080301378 bestIt: 5 CE: -0.765336283833082"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.768262080301378 bestIt: 5 CE: -0.765336283833082"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.768262080301378 bestIt: 5 CE: -0.765336283833082"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.768262080301378 bestIt: 5 CE: -0.765336283833082"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 11 bestEv: -0.768262080301378 bestIt: 5 CE: -0.552849247389965"</span></span>
<span><span class="co">#&gt; [1] "improvement"</span></span>
<span><span class="co">#&gt;   nsimlr objectiver mixer ebber    optimus    constraint final_energy</span></span>
<span><span class="co">#&gt; 1      2        cca   pca  0.99 lineSearch Stiefelx10x10     15.98724</span></span>
<span><span class="co">#&gt;   prescaling1    prescaling2 prescaling3 sparval1 sparval2 sparval3 positivity1</span></span>
<span><span class="co">#&gt; 1      robust centerAndScale          np      0.5      0.5      0.5    positive</span></span>
<span><span class="co">#&gt;   positivity2 positivity3 perm     m1_m2     m1_m3     m2_m3</span></span>
<span><span class="co">#&gt; 1    positive    positive    0 0.7731677 0.4217462 0.4443339</span></span>
<span><span class="co">#&gt;              PC1         PC2</span></span>
<span><span class="co">#&gt; m3.1 0.000000000 0.001482357</span></span>
<span><span class="co">#&gt; m3.2 0.003105033 0.000000000</span></span>
<span><span class="co">#&gt; m3.3 0.000000000 0.010686503</span></span>
<span><span class="co">#&gt; m3.4 0.000000000 0.000000000</span></span>
<span><span class="co">#&gt; m3.5 0.000000000 0.023650730</span></span>
<span><span class="co">#&gt; m3.6 0.016423998 0.013936366</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Stiefelx1x1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Stiefel" "1"       "1"      </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.857027012460654  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.47653047609036 bestIt: 1 CE: -0.47653047609036"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.694771385142719 bestIt: 2 CE: -0.694771385142719"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.837662061497179 bestIt: 3 CE: -0.83766206149718"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.845114841797893 bestIt: 4 CE: -0.845114841797893"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.87451301199215 bestIt: 5 CE: -0.87451301199215"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.87451301199215 bestIt: 5 CE: -0.874234379955215"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.875228992424385 bestIt: 7 CE: -0.875228992424385"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.884763242068898 bestIt: 8 CE: -0.884763242068898"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.894700997850001 bestIt: 9 CE: -0.894700997850001"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.894700997850001 bestIt: 9 CE: -0.881229074835642"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 11 bestEv: -0.89960923703501 bestIt: 11 CE: -0.89960923703501"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 12 bestEv: -0.908692262274978 bestIt: 12 CE: -0.908692262274978"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 13 bestEv: -0.908692262274978 bestIt: 12 CE: -0.902799735588814"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 14 bestEv: -0.908692262274978 bestIt: 12 CE: -0.902799735588814"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 15 bestEv: -0.908692262274978 bestIt: 12 CE: -0.87759749925849"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 16 bestEv: -0.908692262274978 bestIt: 12 CE: -0.87759749925849"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 17 bestEv: -0.908692262274978 bestIt: 12 CE: -0.87759749925849"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 18 bestEv: -0.908692262274978 bestIt: 12 CE: -0.87759749925849"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "Stiefelx0.1x0.1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "Stiefel" "0.1"     "0.1"    </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.917111645375717  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.355967404820103 bestIt: 1 CE: -0.355967404820103"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.355967404820103 bestIt: 1 CE: -0.302103177973874"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.671490785475746 bestIt: 3 CE: -0.671490785475746"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.858188887620578 bestIt: 4 CE: -0.858188887620578"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.874754096348496 bestIt: 5 CE: -0.874754096348496"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.874754096348496 bestIt: 5 CE: -0.850267139384837"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.874754096348496 bestIt: 5 CE: -0.761710261441642"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.87961111056513 bestIt: 8 CE: -0.87961111056513"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.87961111056513 bestIt: 8 CE: -0.856383172165312"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 10 bestEv: -0.905545909098392 bestIt: 10 CE: -0.905545909098392"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 11 bestEv: -0.905545909098392 bestIt: 10 CE: -0.886125641764854"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 12 bestEv: -0.905545909098392 bestIt: 10 CE: -0.883007804056776"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 13 bestEv: -0.905545909098392 bestIt: 10 CE: -0.882883225209442"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 14 bestEv: -0.905545909098392 bestIt: 10 CE: -0.903855294741201"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 15 bestEv: -0.905545909098392 bestIt: 10 CE: -0.874918255105305"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 16 bestEv: -0.905545909098392 bestIt: 10 CE: -0.871591364713644"</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "orthox10x10"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "ortho" "10"    "10"   </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.256180683310025  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.507312461403781 bestIt: 1 CE: -0.507312461403781"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.688154502294652 bestIt: 2 CE: -0.688154502294652"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 9 bestEv: -0.699671381310042 bestIt: 3 CE: -0.699671381310042"</span></span>
<span><span class="co">#&gt; [1] "improvement"</span></span>
<span><span class="co">#&gt;   nsimlr objectiver mixer ebber    optimus  constraint final_energy prescaling1</span></span>
<span><span class="co">#&gt; 1      2        cca   pca  0.99 lineSearch orthox10x10     19.52797      robust</span></span>
<span><span class="co">#&gt;      prescaling2 prescaling3 sparval1 sparval2 sparval3 positivity1 positivity2</span></span>
<span><span class="co">#&gt; 1 centerAndScale          np      0.5      0.5      0.5    positive    positive</span></span>
<span><span class="co">#&gt;   positivity3 perm     m1_m2     m1_m3     m2_m3</span></span>
<span><span class="co">#&gt; 1    positive    0 0.7414637 0.6217357 0.6284296</span></span>
<span><span class="co">#&gt;              PC1         PC2</span></span>
<span><span class="co">#&gt; m3.1 0.028115931 0.000000000</span></span>
<span><span class="co">#&gt; m3.2 0.007094071 0.000000000</span></span>
<span><span class="co">#&gt; m3.3 0.029487447 0.000000000</span></span>
<span><span class="co">#&gt; m3.4 0.008334188 0.000000000</span></span>
<span><span class="co">#&gt; m3.5 0.009841182 0.006295204</span></span>
<span><span class="co">#&gt; m3.6 0.000000000 0.026495010</span></span>
<span><span class="co">#&gt; [1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "orthox1x1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "ortho" "1"     "1"    </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.857027012460654  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.640608661063987 bestIt: 1 CE: -0.640608661063987"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.811112716679046 bestIt: 2 CE: -0.811112716679046"</span></span>
<span><span class="co">#&gt; i 10 ...[1] "robust"         "centerAndScale" "np"            </span></span>
<span><span class="co">#&gt; [1] "cca"</span></span>
<span><span class="co">#&gt; [1] "pca"</span></span>
<span><span class="co">#&gt; [1] "orthox0.1x0.1"</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt; [1] 0.99</span></span>
<span><span class="co">#&gt; [1] "positive" "positive" "positive"</span></span>
<span><span class="co">#&gt; [1] "lineSearch"</span></span>
<span><span class="co">#&gt; [1] "ortho" "0.1"   "0.1"  </span></span>
<span><span class="co">#&gt; [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">#&gt; [1] "initialDataTerm: -0.917111645375717  &lt;o&gt; mixer: pca  &lt;o&gt; E:  cca"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 1 bestEv: -0.493782414451495 bestIt: 1 CE: -0.493782414451495"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 2 bestEv: -0.885838987144042 bestIt: 2 CE: -0.885838987144042"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 3 bestEv: -0.885838987144042 bestIt: 2 CE: -0.881313228930842"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 4 bestEv: -0.885838987144042 bestIt: 2 CE: -0.881313228930842"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 5 bestEv: -0.885838987144042 bestIt: 2 CE: -0.84565784966314"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 6 bestEv: -0.885838987144042 bestIt: 2 CE: -0.834104933282779"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 7 bestEv: -0.885838987144042 bestIt: 2 CE: -0.817884633342666"</span></span>
<span><span class="co">#&gt; [1] "Iteration: 8 bestEv: -0.885838987144042 bestIt: 2 CE: -0.825852104773952"</span></span>
<span><span class="co">#&gt;   nsimlr objectiver mixer ebber    optimus  constraint final_energy prescaling1</span></span>
<span><span class="co">#&gt; 8      2        cca   pca  0.99 lineSearch orthox10x10     19.52797      robust</span></span>
<span><span class="co">#&gt;      prescaling2 prescaling3 sparval1 sparval2 sparval3 positivity1 positivity2</span></span>
<span><span class="co">#&gt; 8 centerAndScale          np      0.5      0.5      0.5    positive    positive</span></span>
<span><span class="co">#&gt;   positivity3 perm     m1_m2     m1_m3     m2_m3</span></span>
<span><span class="co">#&gt; 8    positive    0 0.7414637 0.6217357 0.6284296</span></span>
<span><span class="co">#&gt; el finito</span></span>
<span><span class="va">simlrXs</span><span class="op">$</span><span class="va">paramsearch</span></span>
<span><span class="co">#&gt;    nsimlr objectiver mixer ebber    optimus        constraint final_energy</span></span>
<span><span class="co">#&gt; 1       2        cca   pca  0.99 lineSearch              none     15.12304</span></span>
<span><span class="co">#&gt; 2       2        cca   pca  0.99 lineSearch   Grassmannx10x10     14.68560</span></span>
<span><span class="co">#&gt; 3       2        cca   pca  0.99 lineSearch     Grassmannx1x1     14.71550</span></span>
<span><span class="co">#&gt; 4       2        cca   pca  0.99 lineSearch Grassmannx0.1x0.1     15.11430</span></span>
<span><span class="co">#&gt; 5       2        cca   pca  0.99 lineSearch     Stiefelx10x10     15.98724</span></span>
<span><span class="co">#&gt; 6       2        cca   pca  0.99 lineSearch       Stiefelx1x1     15.59972</span></span>
<span><span class="co">#&gt; 7       2        cca   pca  0.99 lineSearch   Stiefelx0.1x0.1     14.93442</span></span>
<span><span class="co">#&gt; 8       2        cca   pca  0.99 lineSearch       orthox10x10     19.52797</span></span>
<span><span class="co">#&gt; 9       2        cca   pca  0.99 lineSearch         orthox1x1     18.50992</span></span>
<span><span class="co">#&gt; 10      2        cca   pca  0.99 lineSearch     orthox0.1x0.1     14.78189</span></span>
<span><span class="co">#&gt;    prescaling1    prescaling2 prescaling3 sparval1 sparval2 sparval3</span></span>
<span><span class="co">#&gt; 1       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 2       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 3       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 4       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 5       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 6       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 7       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 8       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 9       robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt; 10      robust centerAndScale          np      0.5      0.5      0.5</span></span>
<span><span class="co">#&gt;    positivity1 positivity2 positivity3 perm     m1_m2     m1_m3     m2_m3</span></span>
<span><span class="co">#&gt; 1     positive    positive    positive    0 0.3978730 0.4029476 0.4574523</span></span>
<span><span class="co">#&gt; 2     positive    positive    positive    0 0.5983526 0.5704775 0.4275200</span></span>
<span><span class="co">#&gt; 3     positive    positive    positive    0 0.4576600 0.4044627 0.4753633</span></span>
<span><span class="co">#&gt; 4     positive    positive    positive    0 0.4413322 0.4500521 0.4091796</span></span>
<span><span class="co">#&gt; 5     positive    positive    positive    0 0.7731677 0.4217462 0.4443339</span></span>
<span><span class="co">#&gt; 6     positive    positive    positive    0 0.4954192 0.4415130 0.4643743</span></span>
<span><span class="co">#&gt; 7     positive    positive    positive    0 0.4782384 0.4838122 0.4320946</span></span>
<span><span class="co">#&gt; 8     positive    positive    positive    0 0.7414637 0.6217357 0.6284296</span></span>
<span><span class="co">#&gt; 9     positive    positive    positive    0 0.6147825 0.3888984 0.4125018</span></span>
<span><span class="co">#&gt; 10    positive    positive    positive    0 0.4978481 0.3309805 0.2496383</span></span></code></pre></div>
<p>Finally, <code>simlrXs$paramsearch</code> retrieves the results of
the parameter search. This will show the performance of different
parameter combinations, helping to identify the optimal settings for the
SiMLR algorithm. The “best” result here will have the highest value for
<code>final_energy</code> and its parameters are stored in the
<code>parameters</code> slot.</p>
<p>This section of the vignette demonstrates how to set up a
comprehensive parameter search for the SiMLR algorithm. It shows how to
create custom constraints, define a parameter grid, regularize the
model, and execute the search. The result is an optimized set of
parameters that can be used to enhance the performance of the SiMLR
model on your data.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>We provided a quick overview of potential uses of the SiMLR
framework.<br>
In addition, we provided visualization hints and standards that may be
of use in scientific applications of these methods.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
