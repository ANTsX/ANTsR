<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Produces a threshold value based on cluster or voxel level statistics — statFieldThresh • ANTsR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Produces a threshold value based on cluster or voxel level statistics — statFieldThresh" />
<meta property="og:description" content="Produces a threshold value based on cluster or voxel level statistics" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.6.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MultiChannel.html">Multichannel image proccessing</a>
    </li>
    <li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/antsrTransform.html">Using the antsrTransform class</a>
    </li>
    <li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/rfLesionSeg.html">Multi-resolution voxel-wise neighborhood random forest (MRV-NRF) lesion segmentation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Produces a threshold value based on cluster or voxel level statistics</h1>
    
    <div class="hidden name"><code>statFieldThresh.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produces a threshold value based on cluster or voxel level statistics</p>
    </div>

    <pre class="usage"><span class='fu'>statFieldThresh</span>(
  <span class='no'>x</span>,
  <span class='no'>pval</span>,
  <span class='no'>nvox</span>,
  <span class='no'>n</span>,
  <span class='no'>fwhm</span>,
  <span class='no'>resels</span>,
  <span class='no'>df</span>,
  <span class='no'>fieldType</span>,
  <span class='no'>threshType</span>,
  <span class='kw'>pp</span> <span class='kw'>=</span> <span class='fl'>0.001</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>statistical map of class antsImage</p></td>
    </tr>
    <tr>
      <th>pval</th>
      <td><p>p-value for determining threshold</p></td>
    </tr>
    <tr>
      <th>nvox</th>
      <td><p>minimum desired cluster size (in voxels)</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>number of images in conjunction</p></td>
    </tr>
    <tr>
      <th>fwhm</th>
      <td><p>full width at half maxima</p></td>
    </tr>
    <tr>
      <th>resels</th>
      <td><p>resolution elements in search region</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>degrees of freedom expressed as df = c(degrees of interest, degrees of error)</p></td>
    </tr>
    <tr>
      <th>fieldType</th>
      <td><ul>
<li><p>T:  T-field</p></li>
<li><p>F:  F-field</p></li>
<li><p>X:  Chi-square field'</p></li>
<li><p>Z:  Gaussian field</p></li>
</ul></td>
    </tr>
    <tr>
      <th>threshType</th>
      <td><ul>
<li><p>cRFT:  computes a threshold per expected cluster level probability</p></li>
<li><p>pRFT:  uses the mask and pval calculates the minimum statistical threshold</p></li>
<li><p>cFDR:  uses an uncorrected threshold at the alpha level and then computes and FDR threshold based on cluster maxima</p></li>
<li><p>pFDR:  computes the fdr threshold for the entire field of voxels</p></li>
</ul></td>
    </tr>
    <tr>
      <th>pp</th>
      <td><p>primary (initial) p-value threshold used in FDR methods</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>enables verbose output</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Outputs a statistical value to be used for threshold a SPM</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A statistical threshold level is determined using the estimated p-value <code>pval</code> 
given the provided parameters. "cRFT" and "pRFT" specify the method of estimation 
should use RFT cluster and peak statistic estimates respectively.</p>
<p>In addition to RFT based thresholds the user may choose to utilize false-discovery rate
(FDR) based thresholds. These use a primary p-value threshold (default <code>pp = .001</code>)
to create suprathreshold clusters which in turn are used to determine a final threshold
(utilizing <code>pval</code> at this point). If the estimated peak-FDR statistic is used ("pFDR")
then all suprathreshold voxels are FDR corrected to determine the threshold. If the 
estimated cluster-FDR statistic is used then the cluster maxima are FDR corrected in order
to determine the threshold.</p>
<p>It is important that the user recognize that when statistical analyses are computed
using RFT that the threshold level plays a role in predicting the p-value. This is 
because the probability of obtaining results is weighted against the probability of 
any occurence given the threshold. For example, if two clusters where exactly the
same but had one was obtained using a lower threshold it would have a lower p-value. 
This has been shown with a power analysis using similar parameters to those presented
herein with the additional variable of signal characteristics to demonstrate the effect 
of image modality on analysis (Friston et al., 1996). Therefore, parameters should be 
chosen according to the type of analysis being performed (fMRI, PET, or VBM) and the 
hypothesis being tested. Due to widely varying oppinions on appropriate thresholding
procedures no specific recommendations are made here. This function simply facilitates
the use of several approaches that users may utilize after consulting available literature.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chumbley J., (2010) Topological FDR for neuroimaging</p>
<p>Friston K.J., (1994) Assessing the Significance of Focal Activations Using Their Spatial Extent</p>
<p>Friston K.J., (1996) Detecting Activations in PET and fMRI: Levels of Inference and Power</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># threshold according to estimated peak height</span>
<span class='no'>thresh_image</span> <span class='kw'>&lt;-</span> <span class='fu'>statFieldThresh</span>(<span class='no'>timg</span>, <span class='fl'>.05</span>, <span class='fl'>10</span>, <span class='fl'>1</span>, <span class='no'>mysmooth</span>$<span class='no'>fwhm</span>,
                               <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='no'>fit</span>$<span class='no'>df.residual</span>), <span class='kw'>fieldType</span> <span class='kw'>=</span> <span class='st'>"T"</span>,
                               <span class='kw'>threshType</span> <span class='kw'>=</span> <span class='no'>pRFT</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


