<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multi-scale svd — multiscaleSVD • ANTsR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-scale svd — multiscaleSVD"><meta property="og:description" content="Maggioni's multi-scale SVD algorithm explores the dimensionality of a dataset
by investigating the change in eigenvalues with respect to a scale parameter.
The scale parameter is defined by the radius of a ball that sits at each
point in the data.  The ball, at each scale, is moved across the dataset
and SVD is computed within the intersection of the ball and the data at each
point.  The shape in this collection of eigenvalues, with respect to scale,
enables us to estimate both signal and noise dimensionality and scale.  The
estimate can be computed efficiently on large datasets if the sampling is
chosen appropriately.  The challenge, in this algorithm, is classifying the
dimensions of noise, curvature and data.  This classification currently uses
variations on heuristics suggested in work by Maggioni et al."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/simlr_interpretation.html">simlr_interpretation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-scale svd</h1>
    
    <div class="hidden name"><code>multiscaleSVD.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Maggioni's multi-scale SVD algorithm explores the dimensionality of a dataset
by investigating the change in eigenvalues with respect to a scale parameter.
The scale parameter is defined by the radius of a ball that sits at each
point in the data.  The ball, at each scale, is moved across the dataset
and SVD is computed within the intersection of the ball and the data at each
point.  The shape in this collection of eigenvalues, with respect to scale,
enables us to estimate both signal and noise dimensionality and scale.  The
estimate can be computed efficiently on large datasets if the sampling is
chosen appropriately.  The challenge, in this algorithm, is classifying the
dimensions of noise, curvature and data.  This classification currently uses
variations on heuristics suggested in work by Maggioni et al.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiscaleSVD</span><span class="op">(</span><span class="va">x</span>, <span class="va">r</span>, <span class="va">locn</span>, <span class="va">nev</span>, knn <span class="op">=</span> <span class="fl">0</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, plot <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>input matrix, should be n (samples) by p (measurements)</p></dd>


<dt>r</dt>
<dd><p>radii to explore</p></dd>


<dt>locn</dt>
<dd><p>number of local samples to take at each scale</p></dd>


<dt>nev</dt>
<dd><p>maximum number of eigenvalues to compute</p></dd>


<dt>knn</dt>
<dd><p>randomly sample neighbors to assist with large datasets. set k with this value.</p></dd>


<dt>verbose</dt>
<dd><p>boolean to control verbosity of output</p></dd>


<dt>plot</dt>
<dd><p>boolean to control whether we plot results.  its value determines
which eigenvector off which to base the scale of the y-axis.'</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list with a vector of tangent, curvature, noise dimensionality and a
a dataframe containing eigenvalues across scale, in correspondence with r:</p><ul><li><p>dim: The tangent, curvature and noise dimensionality vector.  The
data dimensionality is the first entry, the curvature dimensionality exists
from the second to the first entry of the noise vector.</p></li>
<li><p>noiseCutoffs: Dimensionalities where the noise may begin.  These
are candidate cutoffs but may contain some curvature information.'</p></li>
<li><p>evalsVsScale: eigenvalues across scale</p></li>
<li><p>evalClustering:data-driven clustering of the eigenvalues</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p><a href="http://www.math.jhu.edu/~mauro/multiscaledatageometry.html" class="external-link">http://www.math.jhu.edu/~mauro/multiscaledatageometry.html</a></p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Avants BB</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sphereDim</span> <span class="op">&lt;-</span> <span class="fl">9</span></span></span>
<span class="r-in"><span><span class="va">embeddDim</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="usePkg.html">usePkg</a></span><span class="op">(</span><span class="st">"pracma"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20190919</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sphereData</span> <span class="op">&lt;-</span> <span class="fu">pracma</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pracma/man/rand.html" class="external-link">rands</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">sphereDim</span>, <span class="fl">1.</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mysig</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span>  <span class="va">spherEmbed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">embeddDim</span>, <span class="fl">0</span>, <span class="va">mysig</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">embeddDim</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">spherEmbed</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sphereData</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">spherEmbed</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sphereData</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">sphereData</span></span></span>
<span class="r-in"><span>  <span class="va">myr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">2.2</span>, <span class="fl">0.05</span><span class="op">)</span> <span class="co"># scales at which to sample</span></span></span>
<span class="r-in"><span>  <span class="va">mymssvd</span> <span class="op">&lt;-</span> <span class="fu">multiscaleSVD</span><span class="op">(</span><span class="va">spherEmbed</span>, <span class="va">myr</span>, locn <span class="op">=</span> <span class="fl">5</span>, nev <span class="op">=</span> <span class="fl">20</span>, plot <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric_version.html" class="external-link">getRversion</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&lt;</span> <span class="st">"3.6.0"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">mymssvd</span><span class="op">$</span><span class="va">noiseCutoffs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">mymssvd</span><span class="op">$</span><span class="va">evalsVsScale</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">25</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">cm</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.133651668406975</span>, <span class="fl">0.0985695151401464</span>, <span class="fl">0.0914110478052329</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.086272017653314</span>, <span class="fl">0.081188302173622</span>, <span class="fl">0.0766100356616153</span>, <span class="fl">0.0719736252996842</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.067588745051721</span>, <span class="fl">0.0622331185687704</span>, <span class="fl">0.0415236318358749</span>, <span class="fl">0.0192976885668337</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0183063537558787</span>, <span class="fl">0.0174990088862745</span>, <span class="fl">0.0170012938275551</span>, <span class="fl">0.0163859378707545</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0158265354487181</span>, <span class="fl">0.0153357773252783</span>, <span class="fl">0.0147933538908736</span>, <span class="fl">0.0143510807701235</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0140473978346935</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span><span class="va">mymssvd</span><span class="op">$</span><span class="va">noiseCutoffs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">mymssvd</span><span class="op">$</span><span class="va">evalsVsScale</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">25</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">testthat</span><span class="fu">::</span><span class="fu"><a href="https://testthat.r-lib.org/reference/equality-expectations.html" class="external-link">expect_equal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">cm</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.138511257441516</span>, <span class="fl">0.106071822485487</span>, <span class="fl">0.0989441114152412</span>, <span class="fl">0.092910922851038</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0877970523897918</span>, <span class="fl">0.0832570763653118</span>, <span class="fl">0.0782599820599334</span>, <span class="fl">0.0734433988152632</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0678992413676906</span>, <span class="fl">0.0432283615430504</span>, <span class="fl">0.0202481578919003</span>, <span class="fl">0.0191747572787057</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0185718929604774</span>, <span class="fl">0.0178301092823977</span>, <span class="fl">0.0172423799670431</span>, <span class="fl">0.0166981650233669</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.0162072551503541</span>, <span class="fl">0.015784555784915</span>, <span class="fl">0.0153600119986575</span>, <span class="fl">0.0149084240854556</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="multiscaleSVD-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

