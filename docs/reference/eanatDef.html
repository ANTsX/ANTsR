<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Eigenanatomy with deflation — eanatDef • ANTsR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Eigenanatomy with deflation — eanatDef" />
<meta property="og:description" content="Simplified, low-parameter eigenanatomy implemented with deflation. The
algorithm is able to automatically select hidden sparseness
parameters, given the key parameter nvecs.  The user should select the
cthresh and  smoother regularization parameters for a given
application and also based on observing algorithm behavior when
verbose=TRUE." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.6.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/MultiChannel.html">Multichannel image proccessing</a>
    </li>
    <li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/antsrTransform.html">Using the antsrTransform class</a>
    </li>
    <li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/rfLesionSeg.html">Multi-resolution voxel-wise neighborhood random forest (MRV-NRF) lesion segmentation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Eigenanatomy with deflation</h1>
    
    <div class="hidden name"><code>eanatDef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simplified, low-parameter eigenanatomy implemented with deflation. The
algorithm is able to automatically select hidden <code>sparseness</code>
parameters, given the key parameter <code>nvecs</code>.  The user should select the
<code>cthresh</code> and  <code>smoother</code> regularization parameters for a given
application and also based on observing algorithm behavior when
<code>verbose=TRUE</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>eanatDef</span>(
  <span class='no'>inmat</span>,
  <span class='kw'>nvecs</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>mask</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>smoother</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>cthresh</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>its</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>eps</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>positivity</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>priors</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>priorWeight</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>sparEpsilon</span> <span class='kw'>=</span> <span class='fl'>0.0001</span>,
  <span class='kw'>whiten</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>inmat</th>
      <td><p>input matrix</p></td>
    </tr>
    <tr>
      <th>nvecs</th>
      <td><p>number of eigenanatomy vectors to compute. see
<code>eanatSelect</code> for a method to compute an optimal <code>nvecs</code> value.</p></td>
    </tr>
    <tr>
      <th>mask</th>
      <td><p>input mask, must match matrix</p></td>
    </tr>
    <tr>
      <th>smoother</th>
      <td><p>regularization parameter, typically 0 or 0.5, in voxels</p></td>
    </tr>
    <tr>
      <th>cthresh</th>
      <td><p>remove isolated voxel islands of size below this value</p></td>
    </tr>
    <tr>
      <th>its</th>
      <td><p>number of iterations</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>gradient descent parameter</p></td>
    </tr>
    <tr>
      <th>positivity</th>
      <td><p>return unsigned eigenanatomy vectors</p></td>
    </tr>
    <tr>
      <th>priors</th>
      <td><p>external initialization matrix.</p></td>
    </tr>
    <tr>
      <th>priorWeight</th>
      <td><p>weight on priors in range 0 to 1.</p></td>
    </tr>
    <tr>
      <th>sparEpsilon</th>
      <td><p>threshold that controls initial sparseness estimate</p></td>
    </tr>
    <tr>
      <th>whiten</th>
      <td><p>use ICA style whitening.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>controls whether computation is silent or not.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>matrix is output, analogous to <code><a href='https://rdrr.io/r/base/svd.html'>svd(mat,nu=0,nv=nvecs)</a></code></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kandel, B. M.; Wang, D. J. J.; Gee, J. C. &amp; Avants, B. B.
Eigenanatomy: sparse dimensionality reduction for multi-modal medical
image analysis. Methods,  2015, 73, 43-53.
PS Dhillon, DA Wolk, SR Das, LH Ungar, JC Gee, BB Avants
Subject-specific functional parcellation via Prior Based Eigenanatomy
NeuroImage, 2014, 99, 14-27.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='eanatSelect.html'>eanatSelect</a></code> <a href='https://github.com/stnava/blindSourceSeparationInANTsR'>https://github.com/stnava/blindSourceSeparationInANTsR</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>mat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>2000</span>),<span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>50</span>)
<span class='no'>nv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='eanatSelect.html'>eanatSelect</a></span>( <span class='no'>mat</span>, <span class='kw'>selectorScale</span> <span class='kw'>=</span> <span class='fl'>1.2</span> )
<span class='no'>esol</span> <span class='kw'>&lt;-</span> <span class='fu'>eanatDef</span>( <span class='no'>mat</span>, <span class='kw'>nvecs</span><span class='kw'>=</span><span class='no'>nv</span> )
<span class='no'>es2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sparseDecom.html'>sparseDecom</a></span>( <span class='no'>mat</span>, <span class='kw'>nvecs</span> <span class='kw'>=</span> <span class='no'>nv</span> )
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>( <span class='st'>"selected"</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>esol</span>),<span class='st'>'pseudo-eigenvectors'</span>) )
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>( <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>( <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span>( <span class='no'>mat</span> <span class='kw'>%*%</span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span>(<span class='no'>esol</span>)) ) ) ) <span class='co'># what we use to select nvecs</span>
<span class='no'>networkPriors</span> <span class='kw'>=</span> <span class='fu'>getANTsRData</span>(<span class='st'>"fmrinetworks"</span>)
<span class='no'>ilist</span> <span class='kw'>=</span> <span class='no'>networkPriors</span>$<span class='no'>images</span>
<span class='no'>mni</span> <span class='kw'>=</span> <span class='fu'>antsImageRead</span>( <span class='fu'>getANTsRData</span>(<span class='st'>"mni"</span>) )
<span class='no'>mnireg</span> <span class='kw'>=</span> <span class='fu'>antsRegistration</span>( <span class='no'>meanbold</span>*<span class='no'>mask</span>, <span class='no'>mni</span>, <span class='kw'>typeofTransform</span> <span class='kw'>=</span> <span class='st'>'Affine'</span>)
<span class='kw'>for</span> ( <span class='no'>i</span> <span class='kw'>in</span> <span class='fl'>1</span>:<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>ilist</span>) )
  <span class='no'>ilist</span><span class='kw'>[[</span><span class='no'>i</span>]] <span class='kw'>=</span> <span class='fu'>antsApplyTransforms</span>( <span class='no'>meanbold</span>,<span class='no'>ilist</span><span class='kw'>[[</span><span class='no'>i</span>]],<span class='no'>mnireg</span>$<span class='no'>fwdtransform</span> )
<span class='no'>pr</span> <span class='kw'>=</span> <span class='fu'>imageListToMatrix</span>( <span class='no'>ilist</span>, <span class='no'>cortMask</span> )
<span class='no'>esol</span> <span class='kw'>&lt;-</span> <span class='fu'>eanatDef</span>( <span class='no'>boldMat</span>,
  <span class='kw'>nvecs</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>ilist</span>), <span class='no'>cortMask</span>, <span class='kw'>verbose</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
  <span class='kw'>cthresh</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>smoother</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>positivity</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>its</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>priors</span><span class='kw'>=</span><span class='no'>pr</span>,
  <span class='kw'>priorWeight</span><span class='kw'>=</span><span class='fl'>0.15</span>, <span class='kw'>eps</span><span class='kw'>=</span><span class='fl'>0.1</span> )
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


