<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Eigenanatomy with deflation — eanatDef • ANTsR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Eigenanatomy with deflation — eanatDef"><meta property="og:description" content="Simplified, low-parameter eigenanatomy implemented with deflation. The
algorithm is able to automatically select hidden sparseness
parameters, given the key parameter nvecs.  The user should select the
cthresh and  smoother regularization parameters for a given
application and also based on observing algorithm behavior when
verbose=TRUE."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/simlr_interpretation.html">simlr_interpretation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Eigenanatomy with deflation</h1>

    <div class="hidden name"><code>eanatDef.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simplified, low-parameter eigenanatomy implemented with deflation. The
algorithm is able to automatically select hidden <code>sparseness</code>
parameters, given the key parameter <code>nvecs</code>.  The user should select the
<code>cthresh</code> and  <code>smoother</code> regularization parameters for a given
application and also based on observing algorithm behavior when
<code>verbose=TRUE</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eanatDef</span><span class="op">(</span></span>
<span>  <span class="va">inmat</span>,</span>
<span>  nvecs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  mask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  smoother <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  cthresh <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  its <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  positivity <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  priors <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  priorWeight <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sparEpsilon <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  whiten <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-inmat">inmat<a class="anchor" aria-label="anchor" href="#arg-inmat"></a></dt>
<dd><p>input matrix</p></dd>


<dt id="arg-nvecs">nvecs<a class="anchor" aria-label="anchor" href="#arg-nvecs"></a></dt>
<dd><p>number of eigenanatomy vectors to compute. see
<code>eanatSelect</code> for a method to compute an optimal <code>nvecs</code> value.</p></dd>


<dt id="arg-mask">mask<a class="anchor" aria-label="anchor" href="#arg-mask"></a></dt>
<dd><p>input mask, must match matrix</p></dd>


<dt id="arg-smoother">smoother<a class="anchor" aria-label="anchor" href="#arg-smoother"></a></dt>
<dd><p>regularization parameter, typically 0 or 0.5, in voxels</p></dd>


<dt id="arg-cthresh">cthresh<a class="anchor" aria-label="anchor" href="#arg-cthresh"></a></dt>
<dd><p>remove isolated voxel islands of size below this value</p></dd>


<dt id="arg-its">its<a class="anchor" aria-label="anchor" href="#arg-its"></a></dt>
<dd><p>number of iterations</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>gradient descent parameter</p></dd>


<dt id="arg-positivity">positivity<a class="anchor" aria-label="anchor" href="#arg-positivity"></a></dt>
<dd><p>return unsigned eigenanatomy vectors</p></dd>


<dt id="arg-priors">priors<a class="anchor" aria-label="anchor" href="#arg-priors"></a></dt>
<dd><p>external initialization matrix.</p></dd>


<dt id="arg-priorweight">priorWeight<a class="anchor" aria-label="anchor" href="#arg-priorweight"></a></dt>
<dd><p>weight on priors in range 0 to 1.</p></dd>


<dt id="arg-sparepsilon">sparEpsilon<a class="anchor" aria-label="anchor" href="#arg-sparepsilon"></a></dt>
<dd><p>threshold that controls initial sparseness estimate</p></dd>


<dt id="arg-whiten">whiten<a class="anchor" aria-label="anchor" href="#arg-whiten"></a></dt>
<dd><p>use ICA style whitening.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>controls whether computation is silent or not.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>matrix is output, analogous to <code>svd(mat,nu=0,nv=nvecs)</code></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kandel, B. M.; Wang, D. J. J.; Gee, J. C. &amp; Avants, B. B.
Eigenanatomy: sparse dimensionality reduction for multi-modal medical
image analysis. Methods,  2015, 73, 43-53.
PS Dhillon, DA Wolk, SR Das, LH Ungar, JC Gee, BB Avants
Subject-specific functional parcellation via Prior Based Eigenanatomy
NeuroImage, 2014, 99, 14-27.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="eanatSelect.html">eanatSelect</a></code> <a href="https://github.com/stnava/blindSourceSeparationInANTsR" class="external-link">https://github.com/stnava/blindSourceSeparationInANTsR</a></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Avants BB, Tustison NJ</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nv</span> <span class="op">&lt;-</span> <span class="fu"><a href="eanatSelect.html">eanatSelect</a></span><span class="op">(</span><span class="va">mat</span>, selectorScale <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">esol</span> <span class="op">&lt;-</span> <span class="fu">eanatDef</span><span class="op">(</span><span class="va">mat</span>, nvecs <span class="op">=</span> <span class="va">nv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">es2</span> <span class="op">&lt;-</span> <span class="fu"><a href="sparseDecom.html">sparseDecom</a></span><span class="op">(</span><span class="va">mat</span>, nvecs <span class="op">=</span> <span class="va">nv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"selected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">esol</span><span class="op">)</span>, <span class="st">"pseudo-eigenvectors"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">mat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">esol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># what we use to select nvecs</span></span></span>
<span class="r-in"><span><span class="va">networkPriors</span> <span class="op">&lt;-</span> <span class="fu"><a href="getANTsRData.html">getANTsRData</a></span><span class="op">(</span><span class="st">"fmrinetworks"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ilist</span> <span class="op">&lt;-</span> <span class="va">networkPriors</span><span class="op">$</span><span class="va">images</span></span></span>
<span class="r-in"><span><span class="va">mni</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsImageRead.html">antsImageRead</a></span><span class="op">(</span><span class="fu"><a href="getANTsRData.html">getANTsRData</a></span><span class="op">(</span><span class="st">"mni"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mnireg</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsRegistration.html">antsRegistration</a></span><span class="op">(</span><span class="va">meanbold</span> <span class="op">*</span> <span class="va">mask</span>, <span class="va">mni</span>, typeofTransform <span class="op">=</span> <span class="st">"Affine"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ilist</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsApplyTransforms.html">antsApplyTransforms</a></span><span class="op">(</span><span class="va">meanbold</span>, <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">mnireg</span><span class="op">$</span><span class="va">fwdtransform</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="imageListToMatrix.html">imageListToMatrix</a></span><span class="op">(</span><span class="va">ilist</span>, <span class="va">cortMask</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">esol</span> <span class="op">&lt;-</span> <span class="fu">eanatDef</span><span class="op">(</span><span class="va">boldMat</span>,</span></span>
<span class="r-in"><span>  nvecs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ilist</span><span class="op">)</span>, <span class="va">cortMask</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  cthresh <span class="op">=</span> <span class="fl">25</span>, smoother <span class="op">=</span> <span class="fl">0</span>, positivity <span class="op">=</span> <span class="cn">TRUE</span>, its <span class="op">=</span> <span class="fl">10</span>, priors <span class="op">=</span> <span class="va">pr</span>,</span></span>
<span class="r-in"><span>  priorWeight <span class="op">=</span> <span class="fl">0.15</span>, eps <span class="op">=</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

