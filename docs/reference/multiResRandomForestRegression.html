<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>multiple resolution neighborhood random forest regression — multiResRandomForestRegression • ANTsR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="multiple resolution neighborhood random forest regression — multiResRandomForestRegression"><meta property="og:description" content="Represents feature images as a neighborhood across scales
to build a random forest prediction from an image population. A use case
for this function is to predict cognition from multiple image features, e.g.
from the voxelwise FA of the corpus callosum and, in parallel, voxelwise
measurements of the volume of the inferior frontal gyrus."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/MultiChannel.html">Multichannel image proccessing</a>
    </li>
    <li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/antsrTransform.html">Using the antsrTransform class</a>
    </li>
    <li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/simlr_interpretation.html">simlr_interpretation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>multiple resolution neighborhood random forest regression</h1>
    
    <div class="hidden name"><code>multiResRandomForestRegression.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Represents feature images as a neighborhood across scales
to build a random forest prediction from an image population. A use case
for this function is to predict cognition from multiple image features, e.g.
from the voxelwise FA of the corpus callosum and, in parallel, voxelwise
measurements of the volume of the inferior frontal gyrus.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">multiResRandomForestRegression</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">labelmasks</span>,</span>
<span>  rad <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nsamples <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  multiResSchedule <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  ntrees <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>vector of scalar values or labels.  if a factor, do classification,
otherwise regression.</p></dd>


<dt>x</dt>
<dd><p>a list of lists where each list contains feature images</p></dd>


<dt>labelmasks</dt>
<dd><p>a list of masks where each mask defines the image space
for the given list and the number of parallel predictors.  more labels means
more predictors.  alternatively, separate masks may be used for each feature
in which case this should be a list of lists.  see examples.</p></dd>


<dt>rad</dt>
<dd><p>vector of dimensionality d define nhood radius</p></dd>


<dt>nsamples</dt>
<dd><p>(per subject to enter training)</p></dd>


<dt>multiResSchedule</dt>
<dd><p>an integer vector defining multi-res levels</p></dd>


<dt>ntrees</dt>
<dd><p>(for the random forest model)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>list with a random forest model, a vector identifying which rows
correspond to which subjects and a prediction vector.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Pustina, D, et al.  Automated segmentation of chronic stroke
lesions using LINDA: Lesion Identification with Neighborhood Data Analysis,
Human Brain Mapping, 2016. (related work, not identical)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="getMultiResFeatureMatrix.html">getMultiResFeatureMatrix</a></code> <code><a href="mrvnrfs.html">mrvnrfs</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Avants BB, Tustison NJ</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="makeImage.html">makeImage</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mask</span><span class="op">[</span><span class="fl">30</span><span class="op">:</span><span class="fl">60</span>, <span class="fl">30</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">mask</span><span class="op">[</span><span class="fl">35</span><span class="op">:</span><span class="fl">45</span>, <span class="fl">50</span><span class="op">:</span><span class="fl">60</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">ilist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">masklist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">inds</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span></span></span>
<span class="r-in"><span><span class="va">yvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">inds</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scl</span> <span class="op">&lt;-</span> <span class="fl">0.33</span> <span class="co"># a noise parameter</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">inds</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsImageClone.html">antsImageClone</a></span><span class="op">(</span><span class="va">mask</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">imgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsImageClone.html">antsImageClone</a></span><span class="op">(</span><span class="va">mask</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">limg</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsImageClone.html">antsImageClone</a></span><span class="op">(</span><span class="va">mask</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">img</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">scl</span> <span class="op">*</span> <span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="va">scl</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">imgb</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">scl</span> <span class="op">*</span> <span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">+</span> <span class="va">scl</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">img</span>, <span class="va">imgb</span><span class="op">)</span> <span class="co"># two features</span></span></span>
<span class="r-in"><span>  <span class="va">yvec</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span><span class="op">^</span><span class="fl">2.0</span> <span class="co"># a real outcome</span></span></span>
<span class="r-in"><span>  <span class="va">masklist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="antsImageClone.html">antsImageClone</a></span><span class="op">(</span><span class="va">mask</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">featMat</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMultiResFeatureMatrix.html">getMultiResFeatureMatrix</a></span><span class="op">(</span><span class="va">ilist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">masklist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  rad <span class="op">=</span> <span class="va">r</span>, , multiResSchedule <span class="op">=</span> <span class="va">mr</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rfm</span> <span class="op">&lt;-</span> <span class="fu">multiResRandomForestRegression</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yvec</span>, <span class="va">ilist</span>, <span class="va">masklist</span>,</span></span>
<span class="r-in"><span>  rad <span class="op">=</span> <span class="va">r</span>, multiResSchedule <span class="op">=</span> <span class="va">mr</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">preds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rfm</span>, newdata <span class="op">=</span> <span class="va">featMat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># data: https://github.com/stnava/ANTsTutorial/tree/master/phantomData</span></span></span>
<span class="r-in"><span><span class="va">fns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.glob.html" class="external-link">Sys.glob</a></span><span class="op">(</span><span class="st">"phantom*wmgm.jpg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ilist</span> <span class="op">&lt;-</span> <span class="fu"><a href="imageFileNames2ImageList.html">imageFileNames2ImageList</a></span><span class="op">(</span><span class="va">fns</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">masklist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">flist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># 2 labels means 2 sets of side by side predictors and features at each scale</span></span></span>
<span class="r-in"><span>  <span class="va">locseg</span> <span class="op">&lt;-</span> <span class="fu"><a href="kmeansSegmentation.html">kmeansSegmentation</a></span><span class="op">(</span><span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">segmentation</span></span></span>
<span class="r-in"><span>  <span class="va">masklist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">locseg</span>, <span class="va">locseg</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="thresholdImage.html">thresholdImage</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">locseg</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">flist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="iMath.html">iMath</a></span><span class="op">(</span><span class="st">"Laplacian"</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">ilist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="iMath.html">iMath</a></span><span class="op">(</span><span class="st">"Grad"</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">yvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># classification</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">trn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ytrain</span> <span class="op">&lt;-</span> <span class="va">yvec</span><span class="op">[</span><span class="va">trn</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ftrain</span> <span class="op">&lt;-</span> <span class="va">flist</span><span class="op">[</span><span class="va">trn</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mtrain</span> <span class="op">&lt;-</span> <span class="va">masklist</span><span class="op">[</span><span class="va">trn</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">mrrfr</span> <span class="op">&lt;-</span> <span class="fu">multiResRandomForestRegression</span><span class="op">(</span><span class="va">ytrain</span>, <span class="va">ftrain</span>, <span class="va">mtrain</span>,</span></span>
<span class="r-in"><span>  rad <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  nsamples <span class="op">=</span> <span class="va">ns</span>, multiResSchedule <span class="op">=</span> <span class="va">mr</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mypreds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fns</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mymode</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">ux</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">ux</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tabulate.html" class="external-link">tabulate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">ux</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="co"># test set</span></span></span>
<span class="r-in"><span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">fmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="getMultiResFeatureMatrix.html">getMultiResFeatureMatrix</a></span><span class="op">(</span><span class="va">flist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">masklist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    rad <span class="op">=</span> <span class="va">r</span>, multiResSchedule <span class="op">=</span> <span class="va">mr</span>, nsamples <span class="op">=</span> <span class="va">ns</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">myp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mrrfr</span>, newdata <span class="op">=</span> <span class="va">fmat</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">mypreds</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">mymode</span><span class="op">(</span><span class="va">myp</span><span class="op">)</span> <span class="co"># get the most frequent observation</span></span></span>
<span class="r-in"><span>  <span class="co"># use median or mean for continuous predictions</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"predicted"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mypreds</span><span class="op">[</span><span class="op">-</span><span class="va">trn</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"ground truth"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">yvec</span><span class="op">[</span><span class="op">-</span><span class="va">trn</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

