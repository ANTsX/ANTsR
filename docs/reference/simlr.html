<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Similarity-driven multiview linear reconstruction model (simlr) for N modalities — simlr • ANTsR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Similarity-driven multiview linear reconstruction model (simlr) for N modalities — simlr"><meta property="og:description" content="simlr minimizes reconstruction error across related modalities.  That is,
simlr will reconstruct each modality matrix from a basis set derived from
the other modalities.  The basis set can be derived from SVD, ICA or a
simple sum of basis representations.
This function produces dataset-wide multivariate beta maps for each of the
related matrices.  The multivariate beta maps are regularized by user
input matrices that encode relationships between variables.  The idea is
overall similar to canonical correlation analysis but generalizes the basis
construction and to arbitrary numbers of modalities."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ANTsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/ANTsR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/deformationSimulation.html">Simulate a deformation field with ANTsR</a>
    </li>
    <li>
      <a href="../articles/iMath.html">iMath (mathematical operations inside ANTsR)</a>
    </li>
    <li>
      <a href="../articles/multivarTemplateCoordinates.html">multivariate template coordinates example for eigenanatomy</a>
    </li>
    <li>
      <a href="../articles/RestingBOLD.html">Resting BOLD (basic analyses using ANTsR)</a>
    </li>
    <li>
      <a href="../articles/simlr_interpretation.html">simlr_interpretation</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Similarity-driven multiview linear reconstruction model (simlr) for N modalities</h1>

    <div class="hidden name"><code>simlr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>simlr minimizes reconstruction error across related modalities.  That is,
simlr will reconstruct each modality matrix from a basis set derived from
the other modalities.  The basis set can be derived from SVD, ICA or a
simple sum of basis representations.
This function produces dataset-wide multivariate beta maps for each of the
related matrices.  The multivariate beta maps are regularized by user
input matrices that encode relationships between variables.  The idea is
overall similar to canonical correlation analysis but generalizes the basis
construction and to arbitrary numbers of modalities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simlr</span><span class="op">(</span></span>
<span>  <span class="va">data_matrices</span>,</span>
<span>  <span class="va">smoothingMatrices</span>,</span>
<span>  iterations <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  <span class="va">sparsenessQuantiles</span>,</span>
<span>  <span class="va">positivities</span>,</span>
<span>  <span class="va">initialUMatrix</span>,</span>
<span>  mixAlg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"svd"</span>, <span class="st">"ica"</span>, <span class="st">"avg"</span>, <span class="st">"rrpca-l"</span>, <span class="st">"rrpca-s"</span>, <span class="st">"pca"</span>, <span class="st">"stochastic"</span><span class="op">)</span>,</span>
<span>  repeatedMeasures <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  lineSearchRange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">500</span><span class="op">)</span>,</span>
<span>  lineSearchTolerance <span class="op">=</span> <span class="fl">1e-12</span>,</span>
<span>  randomSeed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  constraint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"orthox0x1"</span>, <span class="st">"Grassmannx0"</span>, <span class="st">"Stiefelx0"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  energyType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cca"</span>, <span class="st">"regression"</span>, <span class="st">"normalized"</span>, <span class="st">"ucca"</span>, <span class="st">"lowRank"</span>,</span>
<span>    <span class="st">"lowRankRegression"</span>, <span class="st">"normalized_correlation"</span>, <span class="st">"acc"</span>, <span class="st">"nc"</span>, <span class="st">"dat"</span>, <span class="st">"lrr"</span>, <span class="st">"reconorm"</span>,</span>
<span>    <span class="st">"logcosh"</span>, <span class="st">"exp"</span>, <span class="st">"kurtosis"</span>, <span class="st">"gauss"</span><span class="op">)</span>,</span>
<span>  <span class="va">vmats</span>,</span>
<span>  connectors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  optimizationStyle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"armijo_gradient"</span>, <span class="st">"lookahead"</span>, <span class="st">"bidirectional_lookahead"</span>,</span>
<span>    <span class="st">"bidirectional_armijo_gradient"</span><span class="op">)</span>,</span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"eigenvalue"</span><span class="op">)</span>,</span>
<span>  expBeta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  jointInitialization <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sparsenessAlg <span class="op">=</span> <span class="st">"soft"</span>,</span>
<span>  orthogonalizeU <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  domainMatrices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  domainLambdas <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data-matrices">data_matrices<a class="anchor" aria-label="anchor" href="#arg-data-matrices"></a></dt>
<dd><p>A list that contains the named matrices.  Note: the optimization will likely perform much more smoothly if the input matrices are each scaled to zero mean unit variance e.g. by the <code>scale</code> function.</p></dd>


<dt id="arg-smoothingmatrices">smoothingMatrices<a class="anchor" aria-label="anchor" href="#arg-smoothingmatrices"></a></dt>
<dd><p>list of (sparse) matrices that allow parameter smoothing/regularization.  These should be square and same order and size of input matrices.</p></dd>


<dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>number of gradient descent iterations</p></dd>


<dt id="arg-sparsenessquantiles">sparsenessQuantiles<a class="anchor" aria-label="anchor" href="#arg-sparsenessquantiles"></a></dt>
<dd><p>vector of quantiles to control sparseness - higher is sparser</p></dd>


<dt id="arg-positivities">positivities<a class="anchor" aria-label="anchor" href="#arg-positivities"></a></dt>
<dd><p>vector that sets for each matrix if we restrict to positive or negative solution (beta) weights.
choices are positive, negative or either as expressed as a string.</p></dd>


<dt id="arg-initialumatrix">initialUMatrix<a class="anchor" aria-label="anchor" href="#arg-initialumatrix"></a></dt>
<dd><p>list of initialization matrix size <code>n</code> by <code>k</code> for each modality.  Otherwise, pass a single scalar to control the
number of basis functions in which case random initialization occurs. One
may also pass a single initialization matrix to be used for all matrices.
If this is set to a scalar, or is missing, a random matrix will be used.</p></dd>


<dt id="arg-mixalg">mixAlg<a class="anchor" aria-label="anchor" href="#arg-mixalg"></a></dt>
<dd><p>'svd', 'ica', 'rrpca-l', 'rrpca-s', 'stochastic', 'pca' or 'avg' denotes the algorithm employed when estimating the mixed modality bases</p></dd>


<dt id="arg-repeatedmeasures">repeatedMeasures<a class="anchor" aria-label="anchor" href="#arg-repeatedmeasures"></a></dt>
<dd><p>list of repeated measurement identifiers. this will
allow estimates of per identifier intercept.</p></dd>


<dt id="arg-linesearchrange">lineSearchRange<a class="anchor" aria-label="anchor" href="#arg-linesearchrange"></a></dt>
<dd><p>lower and upper limit used in <code>optimize</code></p></dd>


<dt id="arg-linesearchtolerance">lineSearchTolerance<a class="anchor" aria-label="anchor" href="#arg-linesearchtolerance"></a></dt>
<dd><p>tolerance used in <code>optimize</code>, will be multiplied by each matrix norm such that it scales appropriately with input data</p></dd>


<dt id="arg-randomseed">randomSeed<a class="anchor" aria-label="anchor" href="#arg-randomseed"></a></dt>
<dd><p>controls repeatability of ica-based decomposition</p></dd>


<dt id="arg-constraint">constraint<a class="anchor" aria-label="anchor" href="#arg-constraint"></a></dt>
<dd><p>one of none, Grassmann, GrassmannInv or Stiefel</p></dd>


<dt id="arg-energytype">energyType<a class="anchor" aria-label="anchor" href="#arg-energytype"></a></dt>
<dd><p>one of regression, normalized, lowRank, cca or ucca</p></dd>


<dt id="arg-vmats">vmats<a class="anchor" aria-label="anchor" href="#arg-vmats"></a></dt>
<dd><p>optional initial <code>v</code> matrix list</p></dd>


<dt id="arg-connectors">connectors<a class="anchor" aria-label="anchor" href="#arg-connectors"></a></dt>
<dd><p>a list ( length of projections or number of modalities )
that indicates which modalities should be paired with current modality</p></dd>


<dt id="arg-optimizationstyle">optimizationStyle<a class="anchor" aria-label="anchor" href="#arg-optimizationstyle"></a></dt>
<dd><p>the simlr optimizer</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>options to standardize each matrix. e.g. divide by the square root
of its number of variables (Westerhuis, Kourti, and MacGregor 1998), divide
by the number of variables or center or center and scale or ... (see code).
can be a vector which will apply each strategy in order.</p></dd>


<dt id="arg-expbeta">expBeta<a class="anchor" aria-label="anchor" href="#arg-expbeta"></a></dt>
<dd><p>if greater than zero, use exponential moving average on gradient.</p></dd>


<dt id="arg-jointinitialization">jointInitialization<a class="anchor" aria-label="anchor" href="#arg-jointinitialization"></a></dt>
<dd><p>boolean for initialization options, default TRUE</p></dd>


<dt id="arg-sparsenessalg">sparsenessAlg<a class="anchor" aria-label="anchor" href="#arg-sparsenessalg"></a></dt>
<dd><p>NA is default otherwise basic, spmp or orthorank</p></dd>


<dt id="arg-orthogonalizeu">orthogonalizeU<a class="anchor" aria-label="anchor" href="#arg-orthogonalizeu"></a></dt>
<dd><p>boolean controlling whether we orthogonalize the U matrices</p></dd>


<dt id="arg-domainmatrices">domainMatrices<a class="anchor" aria-label="anchor" href="#arg-domainmatrices"></a></dt>
<dd><p>matrices containing domain knowledge length of <code>data_matrices</code> with number of columns also equal to each corresponding data matrix</p></dd>


<dt id="arg-domainlambdas">domainLambdas<a class="anchor" aria-label="anchor" href="#arg-domainlambdas"></a></dt>
<dd><p>weights for domain knowledge term length of <code>data_matrices</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>boolean to control verbosity of output - set to level <code>2</code>
in order to see more output, specifically the gradient descent parameters.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list of u, x, y, z etc related matrices.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="milr.html">milr</a></code> <code><a href="mild.html">mild</a></code> <code><a href="simlrU.html">simlrU</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>BB Avants.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nsub</span> <span class="op">&lt;-</span> <span class="fl">25</span></span></span>
<span class="r-in"><span><span class="va">npix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">133</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nk</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">outcome</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">outcome3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">nsub</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">view1tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">view2tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">view3tx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">npix</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">nk</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat1</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view1tx</span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view2tx</span></span></span>
<span class="r-in"><span><span class="va">mat3</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">outcome</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">outcome3</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">outcome3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">view3tx</span></span></span>
<span class="r-in"><span><span class="va">matlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vox <span class="op">=</span> <span class="va">mat1</span>, vox2 <span class="op">=</span> <span class="va">mat2</span>, vox3 <span class="op">=</span> <span class="va">mat3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">simlr</span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">mat1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">mat2</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="va">mat3</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">regs</span> <span class="op">&lt;-</span> <span class="fu"><a href="regularizeSimlr.html">regularizeSimlr</a></span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu">simlr</span><span class="op">(</span><span class="va">matlist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred1</span> <span class="op">&lt;-</span> <span class="fu"><a href="predictSimlr.html">predictSimlr</a></span><span class="op">(</span><span class="va">matlist</span>, <span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred2</span> <span class="op">&lt;-</span> <span class="fu"><a href="predictSimlr.html">predictSimlr</a></span><span class="op">(</span><span class="va">matlist</span>, <span class="va">result2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare to permuted data</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nsub</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultp</span> <span class="op">&lt;-</span> <span class="fu">simlr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vox <span class="op">=</span> <span class="va">mat1</span>, vox2 <span class="op">=</span> <span class="va">mat2</span><span class="op">[</span><span class="va">s1</span>, <span class="op">]</span>, vox3 <span class="op">=</span> <span class="va">mat3</span><span class="op">[</span><span class="va">s2</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1p</span> <span class="op">&lt;-</span> <span class="va">mat1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2p</span> <span class="op">&lt;-</span> <span class="va">mat2</span><span class="op">[</span><span class="va">s1</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p3p</span> <span class="op">&lt;-</span> <span class="va">mat3</span><span class="op">[</span><span class="va">s2</span>, <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="op">(</span><span class="va">resultp</span><span class="op">$</span><span class="va">v</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare to SVD</span></span></span>
<span class="r-in"><span><span class="va">svd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat1</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span></span>
<span class="r-in"><span><span class="va">svd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat2</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span></span>
<span class="r-in"><span><span class="va">svd3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></span><span class="op">(</span><span class="va">mat3</span>, nu <span class="op">=</span> <span class="va">nk</span>, nv <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">u</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># real</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p3</span>, <span class="va">p2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># permuted</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1p</span>, <span class="va">p2p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p1p</span>, <span class="va">p3p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">p3p</span>, <span class="va">p2p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># svd</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="antsImageSummary.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">svd1</span>, <span class="va">svd2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">resultp</span> <span class="op">&lt;-</span> <span class="fu">simlr</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>vox <span class="op">=</span> <span class="va">mat1</span>, vox2 <span class="op">=</span> <span class="va">mat2</span><span class="op">[</span><span class="va">s1</span>, <span class="op">]</span>, vox3 <span class="op">=</span> <span class="va">mat3</span><span class="op">[</span><span class="va">s2</span>, <span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  initialUMatrix <span class="op">=</span> <span class="va">nk</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span>, iterations <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  energyType <span class="op">=</span> <span class="st">"normalized"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Brian B Avants.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

